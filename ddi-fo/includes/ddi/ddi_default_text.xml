<?xml version='1.0' encoding='utf-8'?>
<!-- match: ddi:*|text() -->
<!-- value: <fo:block> / [-] -->
<!-- the default text -->

<!--
  Variables set:
  trimmed

  Functions/templates called:
  trim, fix-html
-->

<xsl:template match="ddi:*|text()"
              xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
              xmlns:fo="http://www.w3.org/1999/XSL/Format">

    <!-- Case 1) HTML content -->
    <xsl:if test="$allow-html = 1">
      <xsl:call-template name="fix-html">
        <xsl:with-param name="input-string" select="."/>
      </xsl:call-template>
    </xsl:if>

    <!-- Case 2) No HTML content -->
    <xsl:if test="$allow-html = 0">

      <!-- variables -->
      <xsl:variable name="trimmed">
        <xsl:call-template name="trim">
          <xsl:with-param name="s" select="."/>
        </xsl:call-template>
      </xsl:variable>

      <!-- content -->
      <fo:block linefeed-treatment="preserve" white-space-collapse="false"
                space-after="0.0in">
        <xsl:value-of select="$trimmed"/>
      </fo:block>

    </xsl:if>

</xsl:template>
