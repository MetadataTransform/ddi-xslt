<?xml version='1.0' encoding='utf-8'?>
<!-- Match: / -->
<!-- Value: <fo:root> -->
<!-- the root of the FO document starts and ends in this template -->

<!--
  Sections:                           Value:
  0: Setup FO page sizes and layouts  <fo:layout-master-set>
  1: Outline / Bookmarks              <fo:bookmark-tree>
  2: Cover page                       <fo:page-sequence>
  3: Metadata information             <fo:page-sequence>
  4: TOC                              <fo:page-sequence>
  5: Overview                         <fo:page-sequence>
  6: Files Description                <fo:page-sequence>
  7: Variables List                   <fo:page-sequence>
  8: Variable Groups                  <fo:page-sequence>
  9: Variables Description            <fo:page-sequence>
-->

<xsl:template match="/"
              xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
              xmlns:fo="http://www.w3.org/1999/XSL/Format">

  <!-- content -->
  <fo:root>

    <!-- [0] setup page sizes and layouts -->
    <fo:layout-master-set>

      <!-- A4 page -->
      <fo:simple-page-master master-name="default-page"
                             page-height="297mm" page-width="210mm"
                             margin-left="20mm" margin-right="20mm"
                             margin-top="20mm" margin-bottom="20mm">
        <fo:region-body region-name="xsl-region-body"
                        margin-top="10mm" margin-bottom="10mm" />
        <fo:region-before region-name="xsl-region-before" extent="10mm" />
        <fo:region-after region-name="xsl-region-after" extent="10mm" />
      </fo:simple-page-master>

    </fo:layout-master-set>

    <!-- ============================================ -->
    <!-- [1] Outline / Bookmarks                      -->
    <!-- [fo:bookmark-tree]                           -->
    <!-- ============================================ -->

    <!--
      Variables read:
      show-cover-page, show-metadata-info, show-toc, show-overview
      show-scope-and-coverage, show-producers-and-sponsors,
      show-sampling, show-data-collection, show-data-processing-and-appraisal,
      show-accessibility, show-rights-and-disclaimer, show-files-description,
      show-variable-groups, show-variables-list, show-variables-description

      Functions/templates called:
      nomalize-space(), contains(), concat(), string-length()
      trim
    -->

    <!--
      1: Cover Page                       <fo:bookmark>
      2: Metadata Info                    <fo:bookmark>
      3: TOC                              <fo:bookmark>
      4: Overview                         <fo:bookmark>
      4.1: Scope and Coverage             <fo:bookmark>
      4.2: Producers and Sponsors         <fo:bookmark>
      4.3: Sampling                       <fo:bookmark>
      4.4: Data Collection                <fo:bookmark>
      4.5: Data processing and Appraisal  <fo:bookmark>
      4.6: Accessibility                  <fo:bookmark>
      4.7: Rights and Disclaimer          <fo:bookmark>
      5: Files Description Section        <fo:bookmark>
      6: Variable Groups                  <fo:bookmark>
      7: Variables List                   <fo:bookmark>
      8: Variables Description            <fo:bookmark>
    -->

    <xsl:if test="$show-bookmarks = 1">

      <fo:bookmark-tree>

          <!-- [bookmark] msg Cover_Page -->
          <xsl:if test = "$show-cover-page = 1">
            <fo:bookmark internal-destination = "cover-page">
              <fo:bookmark-title>
                <xsl:value-of select="$msg/*/entry[@key='Cover_Page']"/>
              </fo:bookmark-title>
            </fo:bookmark>
          </xsl:if>

          <!-- [bookmark] msg Document_Information -->
          <xsl:if test="$show-metadata-info = 1">
            <fo:bookmark internal-destination="metadata-info">
              <fo:bookmark-title>
                <xsl:value-of select="$msg/*/entry[@key='Document_Information']"/>
              </fo:bookmark-title>
            </fo:bookmark>
          </xsl:if>

          <!-- msg Table_of_Contents -->
          <xsl:if test="$show-toc = 1">
            <fo:bookmark internal-destination="toc">
              <fo:bookmark-title>
                <xsl:value-of select="$msg/*/entry[@key = 'Table_of_Contents']"/>
              </fo:bookmark-title>
            </fo:bookmark>
          </xsl:if>

          <!-- 4) msg Overview -->
          <xsl:if test="$show-overview = 1">
            <fo:bookmark internal-destination="overview">
              <fo:bookmark-title>
                <xsl:value-of select="$msg/*/entry[@key='Overview']"/>
              </fo:bookmark-title>

              <!-- 4.1) msg Scope_and_Coverage -->
              <xsl:if test="$show-scope-and-coverage = 1">
                <fo:bookmark internal-destination="scope-and-coverage">
                  <fo:bookmark-title>
                    <xsl:value-of select="$msg/*/entry[@key='Scope_and_Coverage']"/>
                  </fo:bookmark-title>
                </fo:bookmark>
              </xsl:if>

              <!-- 4.2) msg Producers_and_Sponsors -->
              <xsl:if test="$show-producers-and-sponsors = 1">
                <fo:bookmark internal-destination="producers-and-sponsors">
                  <fo:bookmark-title>
                    <xsl:value-of select="$msg/*/entry[@key='Producers_and_Sponsors']"/>
                  </fo:bookmark-title>
                </fo:bookmark>
              </xsl:if>

              <!-- 4.3) msg Sampling -->
              <xsl:if test="$show-sampling = 1">
                <fo:bookmark internal-destination="sampling">
                  <fo:bookmark-title>
                    <xsl:value-of select="$msg/*/entry[@key='Sampling']"/>
                  </fo:bookmark-title>
                </fo:bookmark>
              </xsl:if>

              <!-- 4.4) msg Data_Collection -->
              <xsl:if test="$show-data-collection = 1">
                <fo:bookmark internal-destination="data-collection">
                  <fo:bookmark-title>
                    <xsl:value-of select="$msg/*/entry[@key='Data_Collection']"/>
                  </fo:bookmark-title>
                </fo:bookmark>
              </xsl:if>

              <!-- 4.5) msg Data_Processing_and_Appraisal -->
              <xsl:if test="$show-data-processing-and-appraisal = 1">
                <fo:bookmark internal-destination="data-processing-and-appraisal">
                  <fo:bookmark-title>
                    <xsl:value-of select="$msg/*/entry[@key='Data_Processing_and_Appraisal']"/>
                  </fo:bookmark-title>
                </fo:bookmark>
              </xsl:if>

              <!-- 4.6 msg Accessibility -->
              <xsl:if test="$show-accessibility= 1">
                <fo:bookmark internal-destination="accessibility">
                  <fo:bookmark-title>
                    <xsl:value-of select="$msg/*/entry[@key='Accessibility']"/>
                  </fo:bookmark-title>
                </fo:bookmark>
              </xsl:if>

              <!-- 4.7 msg Rights_and_Disclaimer -->
              <xsl:if test="$show-rights-and-disclaimer = 1">
                <fo:bookmark internal-destination="rights-and-disclaimer">
                  <fo:bookmark-title>
                    <xsl:value-of select="$msg/*/entry[@key='Rights_and_Disclaimer']"/>
                  </fo:bookmark-title>
                </fo:bookmark>
              </xsl:if>
            </fo:bookmark>
          </xsl:if>

          <!-- 5) msg Files_Description -->
          <xsl:if test="$show-files-description = 1">
            <fo:bookmark internal-destination="files-description">
              <fo:bookmark-title>
                <xsl:value-of select="$msg/*/entry[@key='Files_Description']"/>
              </fo:bookmark-title>

              <!-- fileName -->
              <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                <fo:bookmark internal-destination="file-{ddi:fileTxt/ddi:fileName/@ID}">
                  <fo:bookmark-title>
                    <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                  </fo:bookmark-title>
                </fo:bookmark>
              </xsl:for-each>
            </fo:bookmark>
          </xsl:if>

          <!-- 6) msg Variable_Groups -->
          <xsl:if test="$show-variable-groups = 1">
            <fo:bookmark internal-destination="variables-groups">
              <fo:bookmark-title>
                <xsl:value-of select="$msg/*/entry[@key='Variables_Groups']"/>
              </fo:bookmark-title>

              <!-- labl -->
              <xsl:for-each select="/ddi:codeBook/ddi:dataDscr/ddi:varGrp">
                <xsl:if test="contains($subset-groups, concat(',',@ID,',')) or string-length($subset-groups)=0">
                  <fo:bookmark internal-destination="vargrp-{@ID}">
                    <fo:bookmark-title>
                      <xsl:value-of select="normalize-space(ddi:labl)"/>
                    </fo:bookmark-title>
                  </fo:bookmark>
                </xsl:if>
              </xsl:for-each>
            </fo:bookmark>
          </xsl:if>

          <!-- 7) msg Variables_List -->
          <xsl:if test="$show-variables-list = 1">
            <fo:bookmark internal-destination="variables-list">
              <fo:bookmark-title>
                <xsl:value-of select="$msg/*/entry[@key='Variables_List']"/>
              </fo:bookmark-title>

              <!-- fileName -->
              <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                <fo:bookmark internal-destination="varlist-{ddi:fileTxt/ddi:fileName/@ID}">
                  <fo:bookmark-title>
                    <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                  </fo:bookmark-title>
                </fo:bookmark>
              </xsl:for-each>
            </fo:bookmark>
          </xsl:if>

          <!-- 8) msg Variables_Description -->
          <xsl:if test="$show-variables-description= 1">
            <fo:bookmark internal-destination="variables-description">
              <fo:bookmark-title>
                <xsl:value-of select="$msg/*/entry[@key='Variables_Description']"/>
              </fo:bookmark-title>

              <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                <fo:bookmark internal-destination="vardesc-{ddi:fileTxt/ddi:fileName/@ID}">
                  <fo:bookmark-title>
                    <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                  </fo:bookmark-title>

                  <xsl:variable name="fileId">
                    <xsl:choose>
                      <xsl:when test="ddi:fileTxt/ddi:fileName/@ID">
                        <xsl:value-of select="ddi:fileTxt/ddi:fileName/@ID" />
                      </xsl:when>
                      <xsl:when test="@ID">
                        <xsl:value-of select="@ID"/>
                      </xsl:when>
                    </xsl:choose>
                  </xsl:variable>

                  <xsl:for-each select="/ddi:codeBook/ddi:dataDscr/ddi:var[@files=$fileId]">
                    <xsl:if test="contains($subset-vars, concat(',',@ID,',')) or string-length($subset-vars)=0 ">
                      <fo:bookmark internal-destination="var-{@ID}">
                        <fo:bookmark-title>
                          <xsl:apply-templates select="@name"/>
                          <xsl:if test="normalize-space(ddi:labl)">
                            <xsl:text>: </xsl:text>
                            <xsl:call-template name="trim">
                              <xsl:with-param name="s" select="ddi:labl"/>
                            </xsl:call-template>
                          </xsl:if>
                        </fo:bookmark-title>
                      </fo:bookmark>
                    </xsl:if>
                  </xsl:for-each>

                </fo:bookmark>
              </xsl:for-each>
            </fo:bookmark>
          </xsl:if>

        </fo:bookmark-tree>
      </xsl:if>

      <!-- ================================================= -->
      <!-- [2] Page sequence: Cover page                     -->
      <!-- [page-sequence]                                   -->
      <!-- ================================================= -->

      <!--
        Variables read:
        show-logo, show-geography, show-cover-page-producer,
        show-report-subtitle

        Functions/templates called:
        normalize-space() [Xpath 1.0]
        trim, isodate-long
      -->

      <xsl:if test="$show-cover-page = 1">
        <fo:page-sequence master-reference="default-page" font-family="Helvetica" font-size="10pt">
          <fo:flow flow-name="xsl-region-body">

            <fo:block id="cover-page">

              <!-- logo graphic -->
              <xsl:if test="$show-logo = 1" >
                <fo:block>
                  <fo:external-graphic src="snd_logo_sv.png" horizontal-align="middle" content-height="5mm"/>
                </fo:block>
              </xsl:if>

              <!-- geography -->
              <!-- [block] $geography -->
              <xsl:if test="$show-geography = 1">
                <fo:block font-size="14pt" font-weight="bold" space-before="0.5in" text-align="center" space-after="0.2in">
                  <xsl:value-of select="$geography"/>
                </fo:block>
              </xsl:if>

              <!-- responsible party -->
              <!-- [block] AuthEnty/@affiliation -->
              <xsl:if test="$show-cover-page-producer = 1">
                <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:rspStmt/ddi:AuthEnty">
                  <fo:block font-size="14pt" font-weight="bold" space-before="0.0in" text-align="center" space-after="0.0in">
                    <xsl:call-template name="trim">
                      <xsl:with-param name="s">
                        <xsl:value-of select="."/>
                      </xsl:with-param>
                    </xsl:call-template>
                    <xsl:if test="@affiliation">,
                      <xsl:value-of select="@affiliation"/>
                    </xsl:if>
                  </fo:block>
                </xsl:for-each>
              </xsl:if>

              <!-- title -->
              <!-- [block] titl -->
              <fo:block font-size="18pt" font-weight="bold" space-before="0.5in" text-align="center" space-after="0.0in">
                <xsl:value-of select="normalize-space(/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:titl)"/>
              </fo:block>

              <!-- $report-title (actually report subtitle) -->
              <xsl:if test="show-report-subtitle">
                <fo:block font-size="16pt" font-weight="bold" space-before="1.0in" text-align="center" space-after="0.0in">
                  <xsl:value-of select="$report-title"/>
                </fo:block>
              </xsl:if>

            </fo:block>
          </fo:flow>
        </fo:page-sequence>
      </xsl:if>

      <!-- ==================================================== -->
      <!-- [3] Page sequence: Metadata information              -->
      <!-- FO: page-sequence with table                         -->
      <!-- ==================================================== -->

      <!--
        Variables read:
        msg, font-family, show-metadata-production,
        default-border, cell-padding

        Functions/templates called:
        boolean(), normalize-space() [Xpath 1.0]
        proportional-column-width() [FO]
        isodate-long
      -->

      <!--
        Metadata producers           <fo:table-row>
        Metadata Production Date     <fo:table-row>
        Metadata Version             <fo:table-row>
        Metadata ID                  <fo:table-row>
        Report Acknowledgements      <fo:block>
        Report Notes                 <fo:block>
      -->

      <xsl:if test="$show-metadata-info = 1">

        <fo:page-sequence master-reference="default-page"
                          font-family="{$font-family}" font-size="10pt">

          <fo:flow flow-name="xsl-region-body">
            <fo:block id="metadata-info" />

            <xsl:if test="boolean($show-metadata-production)">
              <fo:block id="metadata-production" font-size="18pt" font-weight="bold" space-after="0.1in">
                <xsl:value-of select="$msg/*/entry[@key='Metadata_Production']"/>
              </fo:block>

              <fo:table table-layout="fixed" width="100%" space-before="0.0in" space-after="0.2in">
                <fo:table-column column-width="proportional-column-width(20)"/>
                <fo:table-column column-width="proportional-column-width(80)"/>

                <fo:table-body>

                  <!-- metadata producer row -->
                  <xsl:if test="/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:prodStmt/ddi:producer">
                    <fo:table-row>
                      <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                        <fo:block>
                          <xsl:value-of select="$msg/*/entry[@key='Metadata_Producers']"/>
                        </fo:block>
                      </fo:table-cell>
                      <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                        <xsl:apply-templates select="/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:prodStmt/ddi:producer"/>
                      </fo:table-cell>
                    </fo:table-row>
                  </xsl:if>

                  <!-- metadata production date row -->
                  <xsl:if test="/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:prodStmt/ddi:prodDate">
                    <fo:table-row>
                      <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                        <fo:block>
                          <xsl:value-of select="$msg/*/entry[@key='Production_Date']"/>
                        </fo:block>
                      </fo:table-cell>
                      <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                        <fo:block>
                          <xsl:call-template name="isodate-long">
                            <xsl:with-param name="isodate" select="normalize-space(/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:prodStmt/ddi:prodDate)"/>
                          </xsl:call-template>
                        </fo:block>
                      </fo:table-cell>
                    </fo:table-row>
                  </xsl:if>

                  <!-- metadata version row -->
                  <xsl:if test="/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:verStmt/ddi:version">
                    <fo:table-row>
                      <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                        <fo:block>
                          <xsl:value-of select="$msg/*/entry[@key='Version']"/>
                        </fo:block>
                      </fo:table-cell>
                      <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                        <xsl:apply-templates select="/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:verStmt/ddi:version"/>
                      </fo:table-cell>
                    </fo:table-row>
                  </xsl:if>

                  <!-- metadata id row -->
                  <xsl:if test="/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:titlStmt/ddi:IDNo">
                    <fo:table-row>
                      <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                        <fo:block>
                          <xsl:value-of select="$msg/*/entry[@key='Identification']"/>
                        </fo:block>
                      </fo:table-cell>
                      <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                        <xsl:apply-templates select="/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:titlStmt/ddi:IDNo"/>
                      </fo:table-cell>
                    </fo:table-row>
                  </xsl:if>

                  <!-- spacing row -->
                  <fo:table-row>
                    <fo:table-cell>
                      <fo:block> </fo:block>
                    </fo:table-cell>
                  </fo:table-row>

                </fo:table-body>
              </fo:table>
            </xsl:if>

            <!-- report acknowledgements -->
            <xsl:if test="normalize-space($report-acknowledgments)">
              <fo:block font-size="18pt" font-weight="bold" space-after="0.1in">
                <xsl:value-of select="$msg/*/entry[@key='Acknowledgments']"/>
              </fo:block>
              <fo:block font-size="10pt" space-after="0.2in">
                <xsl:value-of select="$report-acknowledgments"/>
              </fo:block>
            </xsl:if>

            <!-- report notes -->
            <xsl:if test="normalize-space($report-notes)">
              <fo:block font-size="18pt" font-weight="bold" space-after="0.1in">
                <xsl:value-of select="$msg/*/entry[@key='Notes']"/>
              </fo:block>
              <fo:block font-size="10pt" space-after="0.2in">
                <xsl:value-of select="$report-notes"/>
              </fo:block>
            </xsl:if>

          </fo:flow>
        </fo:page-sequence>
      </xsl:if>


      <!-- ============================================== -->
      <!-- [4] Page sequence: TOC                         -->
      <!-- <fo:page-sequence>                             -->
      <!-- ============================================== -->

      <!--
        Variables read:
        font-family, msg, show-overview, show-scope-and-coverage,
        show-producers-and-sponsors, show-sampling, show-data-collection
        show-data-processing-and-appraisal, show-accessibility,
        show-rights-and-disclaimer, show-files-description, show-variables-list
        show-variable-groups, subset-groups

        Functions called:
        normalize-space(), string-length(), contains(), concat()
      -->

      <!--
        1: Overview                       <fo:block>
        2: Scope and Coverage             <fo:block>
        3: Producers and Sponsors         <fo:block>
        4: Sampling                       <fo:block>
        5: Data Collection                <fo:block>
        6: Data Processing and Appraisal  <fo:block>
        7: Accessibility                  <fo:block>
        8: Rights and Disclaimer          <fo:block>
        9: Files and Description          <fo:block>
       10: Variables List                 <fo:block>
       11: Variable Groups                <fo:block>
       12: Variables Description          <fo:block>
      -->

      <xsl:if test="$show-toc = 1">

        <fo:page-sequence master-reference="default-page"
                          font-family="{$font-family}" font-size="10pt">

          <fo:flow flow-name="xsl-region-body">

            <!-- [block] msg Table_of_Contents -->
            <fo:block id="toc" font-size="18pt" font-weight="bold" space-before="0.5in" text-align="center" space-after="0.1in">
              <xsl:value-of select="$msg/*/entry[@key='Table_of_Contents']"/>
            </fo:block>

            <fo:block margin-left="0.5in" margin-right="0.5in">

              <!-- 1) [block] msg Overview -->
              <xsl:if test="$show-overview = 1">
                <fo:block font-size="10pt" text-align-last="justify">
                  <fo:basic-link internal-destination="overview" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Overview']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="overview"/>
                  </fo:basic-link>
                </fo:block>
              </xsl:if>

              <!-- 2) [block] msg Scope_and_Coverage -->
              <xsl:if test="$show-scope-and-coverage = 1">
                <fo:block font-size="10pt" text-align-last="justify">
                  <fo:basic-link internal-destination="scope-and-coverage" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Scope_and_Coverage']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="scope-and-coverage"/>
                  </fo:basic-link>
                </fo:block>
              </xsl:if>

              <!-- 3) [block] msg Producers_and_Sponsors -->
              <xsl:if test="$show-producers-and-sponsors = 1">
                <fo:block font-size="10pt" text-align-last="justify">
                  <fo:basic-link internal-destination="producers-and-sponsors" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Producers_and_Sponsors']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="producers-and-sponsors"/>
                  </fo:basic-link>
                </fo:block>
              </xsl:if>

              <!-- 4) [fo:block] Sampling -->
              <xsl:if test="$show-sampling = 1">
                <fo:block font-size="10pt" text-align-last="justify">
                  <fo:basic-link internal-destination="sampling" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Sampling']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="sampling"/>
                  </fo:basic-link>
                </fo:block>
              </xsl:if>

              <!-- 5) [block] msg Data_Collection -->
              <xsl:if test="$show-data-collection = 1">
                <fo:block font-size="10pt" text-align-last="justify">
                  <fo:basic-link internal-destination="data-collection" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Data_Collection']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="data-collection"/>
                  </fo:basic-link>
                </fo:block>
              </xsl:if>

              <!-- 6) [block] msg Data_Processing_and_Appraisal -->
              <xsl:if test="$show-data-processing-and-appraisal = 1">
                <fo:block font-size="10pt" text-align-last="justify">
                  <fo:basic-link internal-destination="data-processing-and-appraisal" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Data_Processing_and_Appraisal']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="data-processing-and-appraisal"/>
                  </fo:basic-link>
                </fo:block>
              </xsl:if>

              <!-- 7) [block] msg Accessibility -->
              <xsl:if test="$show-accessibility= 1">
                <fo:block font-size="10pt" text-align-last="justify">
                  <fo:basic-link internal-destination="accessibility" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Accessibility']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="accessibility"/>
                  </fo:basic-link>
                </fo:block>
              </xsl:if>

              <!-- 8) [block] msg Rights_and_Disclaimer -->
              <xsl:if test="$show-rights-and-disclaimer = 1">
                <fo:block font-size="10pt" text-align-last="justify">
                  <fo:basic-link internal-destination="rights-and-disclaimer" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Rights_and_Disclaimer']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="rights-and-disclaimer"/>
                  </fo:basic-link>
                </fo:block>
              </xsl:if>

              <!-- 9) [block] msg Files_Description, fileName -->
              <xsl:if test="$show-files-description = 1">
                <fo:block font-size="10pt" text-align-last="justify">

                  <fo:basic-link internal-destination="files-description" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Files_Description']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="files-description"/>
                  </fo:basic-link>

                  <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                    <fo:block margin-left="0.7in" font-size="10pt" text-align-last="justify">
                      <fo:basic-link internal-destination="file-{ddi:fileTxt/ddi:fileName/@ID}" text-decoration="underline" color="blue">
                        <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                        <fo:leader leader-pattern="dots"/>
                        <fo:page-number-citation ref-id="file-{ddi:fileTxt/ddi:fileName/@ID}"/>
                      </fo:basic-link>
                    </fo:block>
                  </xsl:for-each>

                </fo:block>
              </xsl:if>

              <!-- 10) [block] msg Variables_List, fileName -->
              <xsl:if test="$show-variables-list = 1">
                <fo:block font-size="10pt" text-align-last="justify">
                  <fo:basic-link internal-destination="variables-list" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Variables_List']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="variables-list"/>
                  </fo:basic-link>
                  <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                    <fo:block margin-left="0.7in" font-size="10pt" text-align-last="justify">
                      <fo:basic-link internal-destination="varlist-{ddi:fileTxt/ddi:fileName/@ID}" text-decoration="underline" color="blue">
                        <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                        <fo:leader leader-pattern="dots"/>
                        <fo:page-number-citation ref-id="varlist-{ddi:fileTxt/ddi:fileName/@ID}"/>
                      </fo:basic-link>
                    </fo:block>
                  </xsl:for-each>
                </fo:block>
              </xsl:if>

              <!-- 11) [block] msg Variable_Groups -->
              <xsl:if test="$show-variable-groups = 1">
                <fo:block font-size="10pt" text-align-last="justify">
                  <fo:basic-link internal-destination="variables-groups" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Variables_Groups']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="variables-groups"/>
                  </fo:basic-link>

                  <xsl:for-each select="/ddi:codeBook/ddi:dataDscr/ddi:varGrp">
                    <!-- Show group if its part of subset OR no subset is defined -->
                    <xsl:if test="contains($subset-groups,concat(',',@ID,',')) or string-length($subset-groups)=0">
                      <fo:block margin-left="0.7in" font-size="10pt" text-align-last="justify">
                        <fo:basic-link internal-destination="vargrp-{@ID}" text-decoration="underline" color="blue">
                          <xsl:value-of select="normalize-space(ddi:labl)"/>
                          <fo:leader leader-pattern="dots"/>
                          <fo:page-number-citation ref-id="vargrp-{@ID}"/>
                        </fo:basic-link>
                      </fo:block>
                    </xsl:if>
                  </xsl:for-each>
                </fo:block>
              </xsl:if>

              <!-- 12) [block] Variables_Description, fileDscr/fileName -->
              <xsl:if test="$show-variables-description = 1">
                <fo:block font-size="10pt" text-align-last="justify">

                  <fo:basic-link internal-destination="variables-description" text-decoration="underline" color="blue">
                    <xsl:value-of select="$msg/*/entry[@key='Variables_Description']"/>
                    <fo:leader leader-pattern="dots"/>
                    <fo:page-number-citation ref-id="variables-description"/>
                  </fo:basic-link>

                  <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                    <fo:block margin-left="0.7in" font-size="10pt" text-align-last="justify">
                      <fo:basic-link internal-destination="vardesc-{ddi:fileTxt/ddi:fileName/@ID}" text-decoration="underline" color="blue">
                        <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                        <fo:leader leader-pattern="dots"/>
                        <fo:page-number-citation ref-id="vardesc-{ddi:fileTxt/ddi:fileName/@ID}"/>
                      </fo:basic-link>
                    </fo:block>
                  </xsl:for-each>

                </fo:block>
              </xsl:if>

            </fo:block>
          </fo:flow>
        </fo:page-sequence>
      </xsl:if>


      <!-- ================================================ -->
      <!-- [5] Page sequence: Overview                      -->
      <!-- <fo:page-sequence>                               -->
      <!-- ================================================ -->

      <!--
        Variables read:
        msg, report-start-page-number, font-family, color-gray3
        default-border, cell-padding, survey-title, color-gray1, time

        Functions/templates called:
        nomalize-space(), position() [Xpath]
        proportional-column-width() [FO]
        header, footer
      -->

      <xsl:if test="$show-overview = 1">

        <fo:page-sequence master-reference="default-page"
                          initial-page-number="{$report-start-page-number}"
                          font-family="{$font-family}"
                          font-size="10pt">

          <!-- page header -->
          <xsl:call-template name="header">
            <xsl:with-param name="section">
              <xsl:value-of select="$msg/*/entry[@key='Overview']" />
            </xsl:with-param>
          </xsl:call-template>

          <!-- page footer-->
          <xsl:call-template name="footer" />

          <!-- page [flow] -->
          <fo:flow flow-name="xsl-region-body">
            <fo:table table-layout="fixed" width="100%">
              <fo:table-column column-width="proportional-column-width(20)" />
              <fo:table-column column-width="proportional-column-width(80)" />

              <fo:table-body>

                <!-- Title header -->
                <fo:table-row background-color="{$color-gray3}">
                  <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">

                    <!-- [block] $survey-title -->
                    <fo:block font-size="14pt" font-weight="bold">
                      <xsl:value-of select="$survey-title" />
                    </fo:block>

                    <!-- [block] parTitl -->
                    <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:parTitl">
                      <fo:block font-size="12pt" font-weight="bold" font-style="italic">
                        <xsl:value-of select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:parTitl"/>
                      </fo:block>
                    </xsl:if>

                  </fo:table-cell>
                </fo:table-row>

                <!-- [table-row] separator ============================= -->
                <fo:table-row height="0.2in">
                  <fo:table-cell number-columns-spanned="2">
                    <fo:block />
                  </fo:table-cell>
                </fo:table-row>

                <!-- [table-row] msg Overview -->
                <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                  <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                    <fo:block id="overview" font-size="12pt" font-weight="bold">
                      <xsl:value-of select="$msg/*/entry[@key='Overview']" />
                    </fo:block>
                  </fo:table-cell>
                </fo:table-row>

                <!-- [table-row] msg Type, serName -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:serStmt/ddi:serName">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Type']" />
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:serStmt/ddi:serName" />
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- [table-row] msg Identification, IDNo -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:IDNo">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Identification']" />
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:IDNo" />
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- [table-row] msg Version -->
                <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:verStmt/ddi:version">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Version']"/>
                      </fo:block>
                    </fo:table-cell>

                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">

                      <!-- [block] msg Production_Date, @date -->
                      <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:verStmt/ddi:version">
                        <xsl:if test="@date">
                          <fo:block>
                            <xsl:value-of select="$msg/*/entry[@key='Production_Date']"/>:
                            <xsl:value-of select="@date"/>
                          </fo:block>
                        </xsl:if>
                        <xsl:apply-templates select="."/>
                      </xsl:for-each>

                      <!-- [block] msg Notes, '.' -->
                      <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:verStmt/ddi:notes">
                        <fo:block text-decoration="underline">
                          <xsl:value-of select="$msg/*/entry[@key='Notes']"/>
                        </fo:block>
                        <xsl:apply-templates select="."/>
                      </xsl:for-each>

                    </fo:table-cell>
                  </fo:table-row>
                </xsl:for-each>

                <!-- [table-row] msg Series, serInfo -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:serStmt/ddi:serInfo">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Series']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:serStmt/ddi:serInfo"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 8) [table-row] msg Abstract, abstract -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:abstract">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Abstract']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:abstract"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 9) [table-row] msg Kind_of_Data, dataKind -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:dataKind">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Kind_of_Data']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:dataKind"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 10) [table-row] msg Unit_of_Analysis, analyUnit -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:anlyUnit">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Unit_of_Analysis']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:anlyUnit"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- [table-row] separator ===================== -->
                <fo:table-row height="0.2in">
                  <fo:table-cell number-columns-spanned="2">
                    <fo:block/>
                  </fo:table-cell>
                </fo:table-row>

                <!-- 11) [table-row] msg Scope_and_Coverage -->
                <xsl:if test="$show-scope-and-coverage = 1">
                  <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block id="scope-and-coverage" font-size="12pt" font-weight="bold">
                        <xsl:value-of select="$msg/*/entry[@key='Scope_and_Coverage']"/>
                      </fo:block>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 12) [table-row] msg Scope, notes -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:notes">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Scope']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:notes"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 13) [table-row] msg Keywords, keyword -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:subject/ddi:keyword">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Keywords']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:subject/ddi:keyword">
                          <xsl:if test="position()&gt;1">, </xsl:if>
                          <xsl:value-of select="normalize-space(.)"/>
                        </xsl:for-each>
                      </fo:block>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 14) [table-row] msg Topics, topcClas -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:subject/ddi:topcClas">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Topics']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:subject/ddi:topcClas">
                          <xsl:if test="position()&gt;1">, </xsl:if>
                          <xsl:value-of select="normalize-space(.)"/>
                        </xsl:for-each>
                      </fo:block>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 15) [table-row] msg Time_Periods, $time/$time-produced -->
                <xsl:if test="string-length($time)&gt;3 or string-length($time-produced)&gt;3">
                  <fo:table-row>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Time_Periods']"/>
                      </fo:block>
                    </fo:table-cell>

                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:choose>
                        <xsl:when test="string-length($time) &gt; 3">
                          <fo:block>
                            <xsl:value-of select="$time"/>
                          </fo:block>
                        </xsl:when>
                        <xsl:when test="string-length($time-produced) &gt; 3">
                          <fo:block>
                            <xsl:value-of select="$time-produced"/>
                          </fo:block>
                        </xsl:when>
                      </xsl:choose>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- [table-row] msg Countries, $geography -->
                <fo:table-row>
                  <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                    <fo:block font-weight="bold" text-decoration="underline">
                      <xsl:value-of select="$msg/*/entry[@key='Countries']"/>
                    </fo:block>
                  </fo:table-cell>
                  <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                    <fo:block>
                      <xsl:value-of select="$geography"/>
                    </fo:block>
                  </fo:table-cell>
                </fo:table-row>

                <!-- [fo:table-row] -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:geogCover">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Geographic_Coverage']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:geogCover"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- [fo:table-row] Universe -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:universe">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Universe']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:universe"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- [table-row] separator ============================= -->
                <fo:table-row height="0.2in">
                  <fo:table-cell number-columns-spanned="2">
                    <fo:block/>
                  </fo:table-cell>
                </fo:table-row>

                <!-- 19) [fo:table-row] Producers and Sponsors -->
                <xsl:if test="$show-producers-and-sponsors = 1">
                  <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block id="producers-and-sponsors" font-size="12pt" font-weight="bold">
                        <xsl:value-of select="$msg/*/entry[@key='Producers_and_Sponsors']"/>
                      </fo:block>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 20) [fo:table-row] Primary Investigator(s) -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:rspStmt/ddi:AuthEnty">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Primary_Investigators']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:rspStmt/ddi:AuthEnty"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 21) [fo:table-row] Other Producer(s) -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:prodStmt/ddi:producer">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Other_Producers']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:prodStmt/ddi:producer"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 22) [fo:table-row] Funding -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:prodStmt/ddi:fundAg">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Funding_Agencies']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:prodStmt/ddi:fundAg"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 23) [fo:table-row] Other Acknowledgements -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:rspStmt/ddi:othId">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Other_Acknowledgments']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:rspStmt/ddi:othId"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- ===[separator]=== -->
                <fo:table-row height="0.2in">
                  <fo:table-cell number-columns-spanned="2">
                    <fo:block/>
                  </fo:table-cell>
                </fo:table-row>

                <!-- 24) [fo:table-row] Sampling -->
                <xsl:if test="$show-sampling = 1">
                  <fo:table-row background-color="{$color-gray1}">
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block id="sampling" font-size="12pt" font-weight="bold">
                        <xsl:value-of select="$msg/*/entry[@key='Sampling']"/>
                      </fo:block>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 25) Sampling Procedure -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:sampProc">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Sampling_Procedure']" />
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:sampProc" />
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 26) [fo:table-row] Deviations from Sample -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:deviat">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Deviations_from_Sample_Design']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:deviat"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 27) [fo:table-row] Response Rate -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:respRate">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Response_Rate']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:respRate"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 28) [fo:table-row] Weighting -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:weight">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Weighting']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:weight"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- [table-row] separator =============================== -->
                <fo:table-row height="0.2in">
                  <fo:table-cell number-columns-spanned="2">
                    <fo:block/>
                  </fo:table-cell>
                </fo:table-row>

                <!-- [fo:table-row] Data Collection -->
                <xsl:if test="$show-data-collection = 1">
                  <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block id="data-collection" font-size="12pt" font-weight="bold">
                        <xsl:value-of select="$msg/*/entry[@key='Data_Collection']"/>
                      </fo:block>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- [fo:table-row] Data Collection Dates -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:collDate">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Data_Collection_Dates']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:collDate"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 31) [fo:table-row] Time Periods -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:timePrd">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Time_Periods']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:timePrd"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 32) [fo:table-row] Data Collection Mode -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:collMode">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Data_Collection_Mode']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:collMode"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 33) [fo:table-row] DDP Data Collection Notes -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes[@subject='collection']">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Data_Collection_Notes']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes[@subject='collection']"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 34) [fo:table-row] DDP Data Processing Notes -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes[@subject='processing']">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Data_Processing_Notes']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes[@subject='collection']"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 35) [fo:table-row] DDP Data Cleaning Notes -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes[@subject='cleaning']">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Data_Cleaning_Notes']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes[@subject='collection']"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 36) [fo:table-row] Default -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:collSitu">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Data_Collection_Notes']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:collSitu"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 37) [fo:table-row] Questionnaires -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:resInstru">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Questionnaires']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:resInstru"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 38) [fo:table-row] Data Collectors -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:dataCollector">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Data_Collectors']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:dataCollector"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 39) [fo:table-row] Supervision -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:actMin">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Supervision']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:actMin"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- [fo:table-row] separator -->
                <fo:table-row height="0.2in">
                  <fo:table-cell number-columns-spanned="2">
                    <fo:block/>
                  </fo:table-cell>
                </fo:table-row>

                <!-- 40) [fo:table-row] Data Processing and Appraisal -->
                <xsl:if test="$show-data-processing-and-appraisal = 1">
                  <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block id="data-processing-and-appraisal" font-size="12pt" font-weight="bold">
                        <xsl:value-of select="$msg/*/entry[@key='Data_Processing_and_Appraisal']"/>
                      </fo:block>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 41) [fo:table-row] Data Editing -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:cleanOps">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Data_Editing']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:cleanOps"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 42) [fo:table-row] Other Processing -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Other_Processing']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 43) [fo:table-row] Estimates of Sampling Error -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:EstSmpErr">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Estimates_of_Sampling_Error']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:EstSmpErr"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 44) [fo:table-row] Other Data Appraisal -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:dataAppr">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Other_Forms_of_Data_Appraisal']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:dataAppr"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- [fo:table-row] (separator) -->
                <fo:table-row height="0.2in">
                  <fo:table-cell number-columns-spanned="2">
                    <fo:block/>
                  </fo:table-cell>
                </fo:table-row>

                <!-- 45) [fo:table-row] Accesibility -->
                <xsl:if test="$show-accessibility = 1">
                  <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block id="accessibility" font-size="12pt" font-weight="bold">
                        <xsl:value-of select="$msg/*/entry[@key='Accessibility']"/>
                      </fo:block>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 46) [fo:table-row] Access Authority -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:contact">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Access_Authority']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:contact"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 47) [fo:table-row] Contacts -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:contact">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Contacts']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:contact"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 48) [fo:table-row] Distributor -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:distrbtr">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Distributors']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:distrbtr"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 49) [fo:table-row] Depositor (DDP) -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:depositr">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Depositors']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:depositr"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 50) [fo:table-row] Confidentiality -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:confDec">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Confidentiality']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:confDec"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 51) [fo:table-row] Access Conditions -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:conditions">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Access_Conditions']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:conditions"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- 52) [fo:table-row] Citation Requierments -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:citReq">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Citation_Requirements']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:citReq"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- =separator= -->
                <fo:table-row height="0.2in">
                  <fo:table-cell number-columns-spanned="2">
                    <fo:block/>
                  </fo:table-cell>
                </fo:table-row>

                <!-- 53) [fo:table-row] Rights and Disclaimer -->
                <xsl:if test="$show-rights-and-disclaimer = 1">
                  <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block id="rights-and-disclaimer" font-size="12pt" font-weight="bold">
                        <xsl:value-of select="$msg/*/entry[@key='Rights_and_Disclaimer']"/>
                      </fo:block>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- Disclaimer -->
                <!-- [table-row] msg Disclaimer, disclaimer  -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:disclaimer">
                  <fo:table-row>
                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block font-weight="bold" text-decoration="underline">
                        <xsl:value-of select="$msg/*/entry[@key='Disclaimer']"/>
                      </fo:block>
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:disclaimer"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

                <!-- Copyright -->
                <!-- [table-row] msg Copyright, copyright -->
                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:prodStmt/ddi:copyright">
                  <fo:table-row>
                    <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                      <fo:block>
                        <xsl:value-of select="$msg/*/entry[@key='Copyright']"/>
                      </fo:block>
                    </fo:table-cell>
                    <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                      <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:prodStmt/ddi:copyright"/>
                    </fo:table-cell>
                  </fo:table-row>
                </xsl:if>

              </fo:table-body>
            </fo:table>
          </fo:flow>
        </fo:page-sequence>
      </xsl:if>


      <!-- ======================================================== -->
      <!-- [6] Page sequence: Files description                     -->
      <!-- <fo:page-sequence>                                       -->
      <!-- ======================================================== -->

      <!--
        Variables read:
        msg, font-family

        Functions/templates called:
        count()
        header, footer
      -->

      <xsl:if test="$show-files-description = 1">

        <fo:page-sequence master-reference="default-page"
                          font-family="{$font-family}"
                          font-size="10pt">

          <!-- page header and footer -->
          <xsl:call-template name="header">
            <xsl:with-param name="section">
              <xsl:value-of select="$msg/*/entry[@key='Files_Description']"/>
            </xsl:with-param>
          </xsl:call-template>
          <xsl:call-template name="footer"/>

          <!-- main flow -->
          <fo:flow flow-name="xsl-region-body">

            <fo:block id="files-description" font-size="18pt" font-weight="bold" space-after="0.1in">
              <xsl:value-of select="$msg/*/entry[@key='Files_Description']"/>
            </fo:block>

            <!-- count -->
            <fo:block font-weight="bold">
              <xsl:value-of select="$msg/*/entry[@key='Dataset_contains']"/>
              <xsl:text> </xsl:text>
              <xsl:value-of select="count(/ddi:codeBook/ddi:fileDscr)"/>
              <xsl:text> </xsl:text>
              <xsl:value-of select="$msg/*/entry[@key='files']"/>
            </fo:block>

            <!-- files -->
            <xsl:apply-templates select="/ddi:codeBook/ddi:fileDscr"/>

          </fo:flow>
        </fo:page-sequence>
      </xsl:if>


      <!-- ================================================ -->
      <!-- [7] Page sequence: Variables list                -->
      <!-- <fo:page-sequence>                               -->
      <!-- ================================================ -->

      <!--
        Variables read:
        msg, show-variables-list-layout, font-family

        Functions/templates called
        count()
        header, footer
      -->

      <xsl:if test="$show-variables-list = 1">

        <fo:page-sequence master-reference="{$show-variables-list-layout}"
                          font-family="{$font-family}" font-size="10pt">

          <!-- page header and footer -->
          <xsl:call-template name="header">
            <xsl:with-param name="section">
              <xsl:value-of select="$msg/*/entry[@key='Variables_List']"/>
            </xsl:with-param>
          </xsl:call-template>
          <xsl:call-template name="footer"/>

          <!-- main flow -->
          <fo:flow flow-name="xsl-region-body">

            <!-- Variables_List -->
            <fo:block id="variables-list" font-size="18pt" font-weight="bold" space-after="0.1in">
              <xsl:value-of select="$msg/*/entry[@key='Variables_List']"/>
            </fo:block>

            <!-- count -->
            <fo:block font-weight="bold">
              <xsl:value-of select="$msg/*/entry[@key='Dataset_contains']"/>
              <xsl:text> </xsl:text>
              <xsl:value-of select="count(/ddi:codeBook/ddi:dataDscr/ddi:var)"/>
              <xsl:text> </xsl:text>
              <xsl:value-of select="$msg/*/entry[@key='variables']"/>
            </fo:block>

            <!-- fileDscr -->
            <xsl:apply-templates select="/ddi:codeBook/ddi:fileDscr" mode="variables-list"/>

          </fo:flow>
        </fo:page-sequence>
      </xsl:if>


      <!-- ================================================ -->
      <!-- [8] Page sequence: Variable groups               -->
      <!-- [fo:page-sequence]                               -->
      <!-- ================================================ -->

      <!--
        Variables read:
        msg, font-family, number-of-groups

        Functions/templates called:
        string-length(), count()
        header, footer
      -->

      <xsl:if test="$show-variable-groups = 1">

        <fo:page-sequence master-reference="default-page"
                          font-family="{$font-family}" font-size="10pt">

          <!-- page header and footer -->
          <xsl:call-template name="header">
            <xsl:with-param name="section">
              <xsl:value-of select="$msg/*/entry[@key='Variables_Groups']"/>
            </xsl:with-param>
          </xsl:call-template>
          <xsl:call-template name="footer"/>

          <!-- page flow -->
          <fo:flow flow-name="xsl-region-body">

            <!-- msg Variables_Groups -->
            <fo:block id="variables-groups" font-size="18pt" font-weight="bold" space-after="0.1in">
              <xsl:value-of select="$msg/*/entry[@key='Variables_Groups']"/>
            </fo:block>

            <!-- count -->
            <fo:block font-weight="bold">
              <xsl:value-of select="$msg/*/entry[@key='Dataset_contains']"/>
              <xsl:text> </xsl:text>
              <xsl:value-of select="count(/ddi:codeBook/ddi:dataDscr/ddi:varGrp)"/>
              <xsl:text> </xsl:text>
              <xsl:value-of select="$msg/*/entry[@key='groups']"/>
              <xsl:if test="string-length($subset-vars)&gt;0">
                <xsl:value-of select="$msg/*/entry[@key='ShowingSubset']"/>
                <xsl:value-of select="$number-of-groups"/>
              </xsl:if>
            </fo:block>

            <!-- varGrp -->
            <xsl:apply-templates select="/ddi:codeBook/ddi:dataDscr/ddi:varGrp"/>

          </fo:flow>
        </fo:page-sequence>
      </xsl:if>


      <!-- ==================================================== -->
      <!-- [9] Page sequence: Variables description             -->
      <!-- <fo:page-sequence>                                   -->
      <!-- ==================================================== -->

      <!--
        Variables read:
        msg, font-family

        Functions/templates called
        count(), string-length()
        header, footer
      -->

      <xsl:if test="$show-variables-description = 1">

        <fo:page-sequence master-reference="default-page"
                          font-family="{$font-family}" font-size="10pt">

          <!-- page header -->
          <xsl:call-template name="header">
            <xsl:with-param name="section">
              <xsl:value-of select="$msg/*/entry[@key='Variables_Description']"/>
            </xsl:with-param>
          </xsl:call-template>

          <!-- page footer-->
          <xsl:call-template name="footer"/>

          <!-- page flow -->
          <fo:flow flow-name="xsl-region-body">

            <!-- Variables_Description -->
            <fo:block id="variables-description" font-size="18pt" font-weight="bold" space-after="0.1in">
              <xsl:value-of select="$msg/*/entry[@key='Variables_Description']"/>
            </fo:block>

            <!-- count -->
            <fo:block font-weight="bold">
              <xsl:value-of select="$msg/*/entry[@key='Dataset_contains']"/>
              <xsl:text> </xsl:text>
              <xsl:value-of select="count(/ddi:codeBook/ddi:dataDscr/ddi:var)"/>
              <xsl:text> </xsl:text>
              <xsl:value-of select="$msg/*/entry[@key='variables']"/>
              <xsl:if test="string-length($subset-vars) &gt; 0">
                <xsl:value-of select="$msg/*/entry[@key='ShowingSubset']"/>
              </xsl:if>
            </fo:block>

          </fo:flow>
        </fo:page-sequence>

        <!-- fileDscr -->
        <xsl:apply-templates select="/ddi:codeBook/ddi:fileDscr" mode="variables-description"/>
      </xsl:if>
 
    </fo:root>

</xsl:template>
