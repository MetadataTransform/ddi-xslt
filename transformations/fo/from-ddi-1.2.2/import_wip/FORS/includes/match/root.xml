<?xml version='1.0' encoding='utf-8' ?>

<xsl:template match="/"
              xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
              xmlns:fo="http://www.w3.org/1999/XSL/Format">

        <!-- FO ROOT -->
        <fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format">

            <!-- LAYOUT MASTER -->
            <fo:layout-master-set>
                <fo:simple-page-master master-name="default-page" page-height="29.7cm" page-width="21cm" margin-left="2cm" margin-right="2cm" margin-top="1cm" margin-bottom=".5cm">
                    <fo:region-body margin-top="1cm" margin-bottom="4cm" region-name="xsl-region-body"/>
                    <fo:region-before extent="1cm" region-name="xsl-region-before"/>
                    <fo:region-after extent="2.5cm" region-name="xsl-region-after"/>
                </fo:simple-page-master>
                <fo:simple-page-master master-name="landscape-page" page-height="21cm" page-width="29.7cm" margin-left="2cm" margin-right="2cm" margin-top="2cm" margin-bottom="2cm">
                    <fo:region-body margin-top="1cm" margin-bottom="4cm" region-name="xsl-region-body"/>
                    <fo:region-before extent="1cm" region-name="xsl-region-before"/>
                    <fo:region-after extent="3cm" region-name="xsl-region-after"/>
                </fo:simple-page-master>
            </fo:layout-master-set>

            <!-- OUTLINE / BOOKMARKS -->
            <fo:bookmark-tree>
                <xsl:if test="$show-toc = 1">
                    <fo:bookmark internal-destination="toc">
                        <fo:bookmark-title>
                            <xsl:value-of select="$msg/*/entry[@key='Table_of_Contents']"/>
                        </fo:bookmark-title>
                    </fo:bookmark>
                </xsl:if>

                <xsl:if test="$show-overview = 1">
                    <!-- Overview bookmarks -->
                    <fo:bookmark internal-destination="overview">
                        <fo:bookmark-title>
                            <xsl:value-of select="$survey-title"/>
                        </fo:bookmark-title>

                        <xsl:if test="$show-scope-and-coverage = 1">
                            <fo:bookmark internal-destination="overview2">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Overview']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <xsl:if test="$show-scope-and-coverage = 1">
                            <fo:bookmark internal-destination="scope-and-coverage">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Scope_and_Coverage']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <xsl:if test="$show-scope-and-coverage = 1">
                            <fo:bookmark internal-destination="coverage">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Coverage']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <xsl:if test="$show-producers-and-sponsors = 1">
                            <fo:bookmark internal-destination="producers-and-sponsors">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Producers_and_Sponsors']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <xsl:if test="$show-sampling = 1">
                            <fo:bookmark internal-destination="sampling">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Sampling']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <xsl:if test="$show-data-collection = 1">
                            <fo:bookmark internal-destination="data-collection">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Data_Collection']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <xsl:if test="$show-data-processing-and-appraisal = 1">
                            <fo:bookmark internal-destination="data-processing-and-appraisal">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Data_Processing_and_Appraisal']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <xsl:if test="$show-accessibility= 1">
                            <fo:bookmark internal-destination="accessibility">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Accessibility']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <xsl:if test="$show-rights-and-disclaimer = 1">
                            <fo:bookmark internal-destination="rights-and-disclaimer">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Rights_and_Disclaimer']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                    </fo:bookmark>
                </xsl:if>

                <!-- file description bookmarks -->
                <xsl:if test="$show-files-description = 1">
                    <fo:bookmark internal-destination="files-description">
                        <fo:bookmark-title>
                            <xsl:value-of select="$msg/*/entry[@key='Files_Description']"/>
                        </fo:bookmark-title>
                        <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                            <fo:bookmark internal-destination="file-{@ID}">
                                <fo:bookmark-title>
                                    <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:for-each>
                    </fo:bookmark>
                </xsl:if>

                <!-- Var groups bookmarks -->
                <fo:bookmark internal-destination="variables-groups">
                    <fo:bookmark-title>
                        <xsl:value-of select="$msg/*/entry[@key='Variables_Groups']"/>
                    </fo:bookmark-title>
                    <xsl:for-each select="/ddi:codeBook/ddi:dataDscr/ddi:varGrp">
                        <xsl:if test="contains($subsetGroups,concat(',',@ID,',')) or string-length($subsetGroups)=0">
                            <fo:bookmark internal-destination="vargrp-{@ID}">
                                <fo:bookmark-title>
                                    <xsl:value-of select="normalize-space(ddi:labl)"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                    </xsl:for-each>
                </fo:bookmark>

                <!-- variables list bookmarks -->
                <xsl:if test="$show-variables-list = 1">
                    <fo:bookmark internal-destination="variables-list">
                        <fo:bookmark-title>
                            <xsl:value-of select="$msg/*/entry[@key='Variables_List']"/>
                        </fo:bookmark-title>
                        <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                            <fo:bookmark internal-destination="varlist-{@ID}">
                                <fo:bookmark-title>
                                    <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:for-each>
                        <!-- Alpha list -->
                        <fo:bookmark internal-destination="variables-list_alpha">
                            <fo:bookmark-title>
                                <xsl:value-of select="$msg/*/entry[@key='Alpha_Varlist']"/>
                            </fo:bookmark-title>
                        </fo:bookmark>
					
                    </fo:bookmark>
                </xsl:if>

                <!-- variables description bookmarks -->
                <xsl:if test="$show-variables-description= 1">
                    <fo:bookmark internal-destination="variables-description">
                        <fo:bookmark-title>
                            <xsl:value-of select="$msg/*/entry[@key='Variables_Description']"/>
                        </fo:bookmark-title>
                        <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                            <fo:bookmark internal-destination="vardesc-{@ID}">
                                <fo:bookmark-title>
                                    <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                                </fo:bookmark-title>
                                <xsl:variable name="fileId" select="@ID"/>
                                <xsl:for-each select="/ddi:codeBook/ddi:dataDscr/ddi:var[@files=$fileId]">
                                    <fo:bookmark internal-destination="var-{@ID}">
                                        <fo:bookmark-title>
                                            <xsl:apply-templates select="@name"/>
                                            <xsl:if test="normalize-space(ddi:labl)">
                                                <xsl:text>: </xsl:text>
                                                <xsl:call-template name="trim">
                                                    <xsl:with-param name="s" select="ddi:labl"/>
                                                </xsl:call-template>
                                            </xsl:if>
                                        </fo:bookmark-title>
                                    </fo:bookmark>
                                </xsl:for-each>
                            </fo:bookmark>
                        </xsl:for-each>
                    </fo:bookmark>
                </xsl:if>

                <!-- documentation bookmark -->
                <xsl:if test="$show-documentation = 1 and /ddi:codeBook/ddi:otherMat">
                    <fo:bookmark internal-destination="documentation">
                        <fo:bookmark-title>
                            <xsl:value-of select="$msg/*/entry[@key='Documentation']"/>
                        </fo:bookmark-title>
                        <!-- report/analytrical -->
                        <xsl:if test="$rep-count >0 or $anl-count > 0">
                            <fo:bookmark  internal-destination="documentation-anl">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Reports_and_analytical_documents']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <!-- questionnaires-->
                        <xsl:if test="$qst-count >0">
                            <fo:bookmark  internal-destination="documentation-qst">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Questionnaires']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <!-- technical-->
                        <xsl:if test="$tec-count >0">
                            <fo:bookmark  internal-destination="documentation-tec">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Technical_documents']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <!-- administrative-->
                        <xsl:if test="$adm-count >0">
                            <fo:bookmark  internal-destination="documentation-adm">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Administrative_documents']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <!-- references -->
                        <xsl:if test="$ref-count >0">
                            <fo:bookmark  internal-destination="documentation-ref">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='References']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <!-- other -->
                        <xsl:if test="$oth-count >0">
                            <fo:bookmark  internal-destination="documentation-oth">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Other_documents']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <!-- statistical tables -->
                        <xsl:if test="$tbl-count >0">
                            <fo:bookmark  internal-destination="documentation-tbl">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Statistical_tables']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <!-- scripts and programs -->
                        <xsl:if test="$prg-count >0">
                            <fo:bookmark  internal-destination="documentation-prg">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Scripts_and_programs']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                        <!-- other resources -->
                        <xsl:if test="$unc-count >0">
                            <fo:bookmark  internal-destination="documentation-unc">
                                <fo:bookmark-title>
                                    <xsl:value-of select="$msg/*/entry[@key='Other_resources']"/>
                                </fo:bookmark-title>
                            </fo:bookmark>
                        </xsl:if>
                    </fo:bookmark>
                </xsl:if>
            </fo:bookmark-tree>

            <!-- PAGE SEQUENCE: COVER PAGE -->
            <xsl:if test="$show-cover-page = 1">
                <fo:page-sequence master-reference="default-page" font-family="{$font-family}" font-size="10pt">
                    <xsl:call-template name="footer_first" />

                    <!-- Page Flow -->
                    <fo:flow flow-name="xsl-region-body">
                        <fo:block id="cover-page" >
                            <fo:table table-layout="fixed" width="100%" space-before="0cm" space-after="0cm">
                                <fo:table-column column-width="proportional-column-width(50)"/>
                                <fo:table-column column-width="proportional-column-width(50)"/>
                                <fo:table-body>
                                    <fo:table-row>
                                        <fo:table-cell font-weight="normal">
                                            <fo:block>
                                                <fo:external-graphic src="url('file:C:/Program Files (x86)/COMPASS Report Center/FORS/fors.jpg')"
                                             content-height="47.25pt" content-width="153pt"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </fo:table-body>
                            </fo:table>
                            <fo:table table-layout="fixed" width="100%" space-before="5cm" space-after="1cm">
                                <fo:table-column column-width="proportional-column-width(50)"/>
                                <fo:table-column column-width="proportional-column-width(50)"/>
                                <fo:table-body>
                                    <!-- Metadata Producer(s) -->
                                    <fo:table-row >
                                        <fo:table-cell font-weight="normal" border-top ="2pt solid rgb(0,150,200)"
                                   border-bottom ="2pt solid rgb(0,150,200)" padding="10pt">
                                            <fo:block>
                                                <fo:external-graphic src="url('file:C:/Program Files (x86)/COMPASS Report Center/FORS/OFS_CH.jpg')" height="35.78pt" width="171.24pt"/>
                                            </fo:block>
                                            <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:rspStmt/ddi:AuthEnty">
                                                <fo:block text-indent="1.05cm" font-size="7.5pt"  color="rgb(0,0,0)" font-weight="normal" space-before="3mm"  space-after="0.5mm">
                                                    <xsl:value-of select="@affiliation"/>
                                                </fo:block>
                                                <fo:block text-indent="1.05cm" font-size="7.5pt"  color="rgb(0,0,0)" font-weight="bold">
                                                    <xsl:call-template name="trim">
                                                        <xsl:with-param name="s">
                                                            <xsl:value-of select="."/>
                                                        </xsl:with-param>
                                                    </xsl:call-template>
                                                </fo:block>
                                            </xsl:for-each>
                                        </fo:table-cell>
                                        <fo:table-cell border-top ="2pt solid rgb(0,150,200)" border-bottom ="2pt solid rgb(0,150,200)" padding="10pt">
                                            <fo:block font-size="16pt" font-weight="normal" color="rgb(0,150,200)"  space-before="0cm" space-after="0.0cm">
                                                <xsl:value-of select="normalize-space(/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:titl)"/>
                                            </fo:block>
                                            <fo:block font-size="11pt" font-weight="bold" color="rgb(0,150,200)"  space-before=".1cm" space-after="0.0cm">
                                                <xsl:value-of select="normalize-space(/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:subTitl)"/>
                                            </fo:block>
                                            <fo:block font-size="11pt" font-weight="bold" color="rgb(0,150,200)"  space-before="0cm" space-after="0.0cm">
                                                <xsl:if test="$time">
                                                    <xsl:value-of select="$time"/>
                                                </xsl:if>													
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </fo:table-body>
                            </fo:table>
                            <fo:table table-layout="fixed" width="100%" space-before="1cm" space-after="0.0cm">
                                <fo:table-column column-width="proportional-column-width(50)"/>
                                <fo:table-column column-width="proportional-column-width(50)"/>
                                <fo:table-body>
                                    <fo:table-row>
                                        <fo:table-cell font-weight="normal">
                                            <fo:block>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell padding="10pt">
		
                                            <fo:block font-family="{$font-family}" font-size="11pt" font-weight="normal" color="rgb(0,150,200)" space-before="0cm" >
                                                <xsl:value-of select="$msg/*/entry[@key='CodeBook']"/>
                                            </fo:block>
                                            <!-- Metadata Production Date -->
                                            <fo:block font-size="11pt" color="rgb(0,150,200)" space-before="8cm" text-align="left" space-after="1cm" >
                                                <xsl:call-template name="isodate-long">
                                                    <xsl:with-param name="isodate" select="normalize-space(/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:prodStmt/ddi:prodDate)"/>
                                                </xsl:call-template>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </fo:table-body>
                            </fo:table>
                        </fo:block>
                    </fo:flow>
                </fo:page-sequence>
            </xsl:if>

            <!-- PAGE SEQUENCE: METADATA INFORMATION -->
            <xsl:if test="$show-metadata-info = 1">
                <fo:page-sequence master-reference="default-page" font-family="{$font-family}" font-size="10pt">
                    <!-- Page Flow -->
                    <fo:flow flow-name="xsl-region-body">
                        <fo:block id="metadata-info"/>
                        <xsl:if test="boolean($show-metadata-production)">
                            <fo:block id="metadata-production" font-size="18pt" font-weight="normal" space-before="18cm" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='Metadata_Production']"/>
                            </fo:block>
                            <fo:table table-layout="fixed" width="100%" space-before="0.0in" space-after="0.2in">
                                <fo:table-column column-width="proportional-column-width(20)"/>
                                <fo:table-column column-width="proportional-column-width(80)"/>
                                <fo:table-body>
                                    <!-- Metadata Producer(s) -->
                                    <xsl:if test="/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:prodStmt/ddi:producer">
                                        <fo:table-row>
                                            <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                                <fo:block>
                                                    <xsl:value-of select="$msg/*/entry[@key='Metadata_Producers']"/>
                                                </fo:block>
                                            </fo:table-cell>
                                            <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                                <fo:block>
                                                    <xsl:apply-templates select="/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:prodStmt/ddi:producer"/>
                                                </fo:block>
                                            </fo:table-cell>
                                        </fo:table-row>
                                    </xsl:if>
									
                                    <!-- Metadata Production Date -->
                                    <xsl:if test="normalize-space(/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:prodStmt/ddi:prodDate)">
                                        <fo:table-row>
                                            <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                                <fo:block>
                                                    <xsl:value-of select="$msg/*/entry[@key='Production_Date']"/>
                                                </fo:block>
                                            </fo:table-cell>
                                            <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                                <fo:block>
                                                    <xsl:call-template name="isodate-long">
                                                        <xsl:with-param name="isodate" select="normalize-space(/ddi:codeBook/ddi:docDscr/ddi:citation/ddi:prodStmt/ddi:prodDate)"/>
                                                    </xsl:call-template>
                                                </fo:block>
                                            </fo:table-cell>
                                        </fo:table-row>
                                    </xsl:if>									
															
                                    <!-- SEPARATOR and prevents error on empty table -->
                                    <fo:table-row height="0.2in" border-top="{$default-border}">
                                        <fo:table-cell number-columns-spanned="2">
                                            <fo:block/>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </fo:table-body>
                            </fo:table>
                        </xsl:if>					
                        <xsl:if test="normalize-space($report-acknowledgments)">
                            <fo:block font-size="18pt" font-weight="normal" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='Acknowledgments']"/>
                            </fo:block>
                            <fo:block font-size="10pt" space-after="0.2in">
                                <xsl:value-of select="$report-acknowledgments"/>
                            </fo:block>
                        </xsl:if>
                        <xsl:if test="normalize-space($report-notes)">
                            <fo:block font-size="18pt" font-weight="normal" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='Notes']"/>
                            </fo:block>
                            <fo:block font-size="10pt" space-after="0.2in">
                                <xsl:value-of select="$report-notes"/>
                            </fo:block>
                        </xsl:if>
                        <fo:block font-size="8pt" space-before="0.2in" text-align="left" space-after="0.1in">
                            <fo:block>
                                <xsl:value-of select="$msg/*/entry[@key='Toolkit_Blurb_PreText']"/>
                                <xsl:text> </xsl:text>
                                <fo:basic-link external-destination="url('http://www.surveynetwork.org/toolkit')" text-decoration="underline" color="{$forsblue}">IHSN Microdata Management Toolkit</fo:basic-link>
                                <xsl:text> </xsl:text>
                                <xsl:value-of select="$msg/*/entry[@key='Toolkit_Blurb_PostText']"/>
                            </fo:block>
                        </fo:block>
                    </fo:flow>
                </fo:page-sequence>
            </xsl:if>

            <!-- PAGE SEQUENCE: TOC -->
            <xsl:if test="$show-toc = 1">
                <fo:page-sequence master-reference="default-page" font-family="{$font-family}" font-size="12pt">
                    <!-- Page Flow -->
                    <fo:flow flow-name="xsl-region-body">
                        <fo:block id="toc" font-size="18pt" font-weight="normal" space-before="0.5in" text-align="left" space-after="0.1in">
                            <xsl:value-of select="$msg/*/entry[@key='Table_of_Contents']"/>
                        </fo:block>
                        <fo:block margin-left="0cm" margin-right="0.5in">

                            <xsl:if test="$show-overview = 1">
                                <fo:block space-before="0.5cm" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="overview" text-decoration="none" color="{$forsblue}">
                                        <!--<xsl:value-of select="$msg/*/entry[@key='Survey_Desc']"/>-->
                                        <xsl:value-of select="$survey-title"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="overview"/>
                                    </fo:basic-link>
                                </fo:block>
                            </xsl:if>
                            <xsl:if test="$show-overview = 1">
                                <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="scope-and-coverage" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Overview']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="overview"/>
                                    </fo:basic-link>
                                </fo:block>
                            </xsl:if>
                            <xsl:if test="$show-scope-and-coverage = 1">
                                <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="scope-and-coverage" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Scope_and_Coverage']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="scope-and-coverage"/>
                                    </fo:basic-link>
                                </fo:block>
                            </xsl:if>		
                            <xsl:if test="$show-scope-and-coverage = 1">
                                <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="coverage" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Coverage']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="coverage"/>
                                    </fo:basic-link>
                                </fo:block>
                            </xsl:if>							
                            <xsl:if test="$show-producers-and-sponsors = 1">
                                <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="producers-and-sponsors" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Producers_and_Sponsors']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="producers-and-sponsors"/>
                                    </fo:basic-link>
                                </fo:block>
                            </xsl:if>
                            <xsl:if test="$show-sampling = 1">
                                <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="sampling" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Sampling']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="sampling"/>
                                    </fo:basic-link>
                                </fo:block>
                            </xsl:if>
                            <xsl:if test="$show-data-collection = 1">
                                <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="data-collection" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Data_Collection']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="data-collection"/>
                                    </fo:basic-link>
                                </fo:block>
                            </xsl:if>
                            <xsl:if test="$show-data-processing-and-appraisal = 1">
                                <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="data-processing-and-appraisal" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Data_Processing_and_Appraisal']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="data-processing-and-appraisal"/>
                                    </fo:basic-link>
                                </fo:block>
                            </xsl:if>
                            <xsl:if test="$show-accessibility= 1">
                                <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="accessibility" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Accessibility']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="accessibility"/>
                                    </fo:basic-link>
                                </fo:block>
                            </xsl:if>
                            <xsl:if test="$show-rights-and-disclaimer = 1">
                                <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="rights-and-disclaimer" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Rights_and_Disclaimer']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="rights-and-disclaimer"/>
                                    </fo:basic-link>
                                </fo:block>
                            </xsl:if>
                            <xsl:if test="$show-files-description = 1">
                                <fo:block space-before="0.5cm" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="files-description" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Files_Description']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="files-description"/>
                                    </fo:basic-link>
                                    <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                                        <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                            <fo:basic-link internal-destination="file-{@ID}" text-decoration="none" color="{$forsblue}">
                                                <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                                                <fo:leader leader-pattern="dots"/>
                                                <fo:page-number-citation ref-id="file-{@ID}"/>
                                            </fo:basic-link>
                                        </fo:block>
                                    </xsl:for-each>
                                </fo:block>
                            </xsl:if>

                            <fo:block space-before="0.5cm" font-size="12pt" text-align-last="justify">
                                <fo:basic-link internal-destination="variables-groups" text-decoration="none" color="{$forsblue}">
                                    <xsl:value-of select="$msg/*/entry[@key='Variables_Groups']"/>
                                    <fo:leader leader-pattern="dots"/>
                                    <fo:page-number-citation ref-id="variables-groups"/>
                                </fo:basic-link>
                                <xsl:for-each select="/ddi:codeBook/ddi:dataDscr/ddi:varGrp">
                                    <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                        <fo:basic-link internal-destination="vargrp-{@ID}" text-decoration="none" color="{$forsblue}">
                                            <xsl:value-of select="normalize-space(ddi:labl)"/>
                                            <fo:leader leader-pattern="dots"/>
                                            <fo:page-number-citation ref-id="vargrp-{@ID}"/>
                                        </fo:basic-link>
                                    </fo:block>
                                </xsl:for-each>
                            </fo:block>


                            <xsl:if test="$show-variables-list = 1">
                                <fo:block space-before="0.5cm" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="variables-list" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Variables_List']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="variables-list"/>
                                    </fo:basic-link>
                                    <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                                        <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                            <fo:basic-link internal-destination="varlist-{@ID}" text-decoration="none" color="{$forsblue}">
                                                <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                                                <fo:leader leader-pattern="dots"/>
                                                <fo:page-number-citation ref-id="varlist-{@ID}"/>
                                            </fo:basic-link>
                                        </fo:block>
                                    </xsl:for-each>
									
                                    <!--Alphabetical list-->
                                    <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                        <fo:basic-link internal-destination="variables-list" text-decoration="none" color="{$forsblue}">
                                            <xsl:value-of select="$msg/*/entry[@key='Alpha_Varlist']"/>
                                            <fo:leader leader-pattern="dots"/>
                                            <fo:page-number-citation ref-id="variables-list_alpha"/>
                                        </fo:basic-link>
                                    </fo:block>
                                </fo:block>
                            </xsl:if>

                            <xsl:if test="$show-variables-description = 1">
                                <fo:block space-before="0.5cm" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="variables-description" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Variables_Description']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="variables-description"/>
                                    </fo:basic-link>
                                    <xsl:for-each select="/ddi:codeBook/ddi:fileDscr">
                                        <fo:block margin-left="0.7in" font-size="12pt" text-align-last="justify">
                                            <fo:basic-link internal-destination="vardesc-{@ID}" text-decoration="none" color="{$forsblue}">
                                                <xsl:apply-templates select="ddi:fileTxt/ddi:fileName"/>
                                                <fo:leader leader-pattern="dots"/>
                                                <fo:page-number-citation ref-id="vardesc-{@ID}"/>
                                            </fo:basic-link>
                                        </fo:block>
                                    </xsl:for-each>
                                </fo:block>
                            </xsl:if>

                            <xsl:if test="$show-documentation">
                                <fo:block space-before="0.5cm" font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="documentation" text-decoration="none" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Documentation']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="documentation"/>
                                    </fo:basic-link>							
                                </fo:block>
                            </xsl:if>
                        </fo:block>
                    </fo:flow>
                </fo:page-sequence>
            </xsl:if>
            <!-- 
                    PAGE SEQUENCE: OVERVIEW 
            -->
            <xsl:if test="$show-overview = 1">
                <fo:page-sequence master-reference="default-page" initial-page-number="{$report-start-page-number}" font-family="{$font-family}" font-size="10pt">

                    <!-- Page Header -->
                    <xsl:call-template name="header">
                        <xsl:with-param name="section">
                            <xsl:value-of select="$msg/*/entry[@key='Overview']"/>
                        </xsl:with-param>
                    </xsl:call-template>

                    <!-- Page Footer-->
                    <xsl:call-template name="footer"/>
                    <!-- Page Flow -->
                    <fo:flow flow-name="xsl-region-body">
                        <fo:table table-layout="fixed" width="100%">
                            <fo:table-column column-width="proportional-column-width(20)"/>
                            <fo:table-column column-width="proportional-column-width(80)"/>
                            <!-- <fo:table-body start-indent="0pt" endt-indent="0pt">--> 
                            <fo:table-body>
                                <!-- 
                                        TITLE HEADER 
                                -->
                                <fo:table-row background-color="{$forsblue}">
                                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                                        <!-- Survey title and abbreviation -->
                                        <fo:block font-size="14pt" font-weight="normal" color="white">
                                            <xsl:value-of select="$survey-title"/>
                                        </fo:block>
                                        <!-- Sub-title -->
                                        <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:subTitl">
                                            <fo:block font-size="12pt" font-weight="bold" color="white">
                                                <xsl:value-of select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:subTitl"/>
                                            </fo:block>
                                        </xsl:if>
										
                                        <!-- Country and Year -->
                                        <fo:block id="overview" font-size="12pt" font-weight="bold" color="white">
                                            <!-- <xsl:value-of select="$geography"/> -->
                                            <xsl:if test="$time">
                                                <xsl:value-of select="$time"/>
                                            </xsl:if>
                                        </fo:block>
                                    </fo:table-cell>
                                </fo:table-row>				

                                <!-- SEPARATOR -->
                                <fo:table-row height="0.2in" border-top="{$default-border}" border-bottom="{$default-border}">
                                    <fo:table-cell number-columns-spanned="2">
                                        <fo:block/>
                                    </fo:table-cell>
                                </fo:table-row>

                                <!-- 
                                        OVERVIEW SECTION (Identification, Version and Overview )
                                -->
                                <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                                    <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                                        <fo:block  id="overview2" font-size="12pt" font-weight="normal">
                                            <xsl:value-of select="$msg/*/entry[@key='Overview']"/>
                                        </fo:block>
                                    </fo:table-cell>
                                </fo:table-row>

                                <!-- 
                                        ABSTRACT 
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:abstract">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold"  border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Abstract']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell  border="{$default-border}" padding="{$cell-padding}" >
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:abstract"  />
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>		

                                <!-- 
                                        VERSION 
                                -->
                                <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:verStmt/ddi:version">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Version']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <!-- production date & description -->
                                                <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:verStmt/ddi:version">
                                                    <xsl:if test="@date">
                                                        <fo:block text-indent="1mm">
                                                            <!--<xsl:value-of select="$msg/*/entry[@key='Data_Date']"/>: <xsl:value-of select="@date"/>-->
                                                        </fo:block>
                                                    </xsl:if>
                                                    <xsl:apply-templates select="."/>
                                                </xsl:for-each>
                                                <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:verStmt/ddi:notes">
                                                    <fo:block text-decoration="underline" text-indent="1mm">
                                                        <xsl:value-of select="$msg/*/entry[@key='Notes']"/>
                                                    </fo:block>
                                                    <xsl:apply-templates select="."/>
                                                </xsl:for-each>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:for-each>


                                <!-- 
                                        Version Date 
                                -->
                                <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:verStmt/ddi:version">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Data_Date']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:verStmt/ddi:version">
                                                    <xsl:if test="@date">
                                                        <fo:block text-indent="1mm">
                                                            <xsl:call-template name="isodate-long">
                                                                <xsl:with-param name="isodate" select="@date"/>
                                                            </xsl:call-template>
                                                        </fo:block>
                                                    </xsl:if>
                                                </xsl:for-each>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:for-each>

                                <!-- 
                                        TYPE 
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:serStmt/ddi:serName">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Type']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:serStmt/ddi:serName"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>


                                <!-- 
                                        SERIES
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:serStmt/ddi:serInfo">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Series']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:serStmt/ddi:serInfo"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        KIND OF DATA 
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:dataKind">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Kind_of_Data']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:dataKind"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        IDENTIFICATION
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:IDNo">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}" >
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Identification']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:titlStmt/ddi:IDNo"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>


                                <!-- SEPARATOR -->
                                <fo:table-row height="0.2in" border-top="{$default-border}" border-bottom="{$default-border}">
                                    <fo:table-cell number-columns-spanned="2">
                                        <fo:block/>
                                    </fo:table-cell>
                                </fo:table-row>

                                <!-- 
                                        *** SCOPE & COVERAGE SECTION (Scope, Coverage) ***
                                -->
                                <xsl:if test="$show-scope-and-coverage = 1">
                                    <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
									
                                        <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block  id="scope-and-coverage" font-size="12pt" font-weight="normal">
                                                <xsl:value-of select="$msg/*/entry[@key='Scope_and_Coverage']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        SCOPE 
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:notes">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Scope']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:notes"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        KEYWORDS
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:subject/ddi:keyword">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Keywords']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:subject/ddi:keyword">
                                                    <xsl:if test="position()>1">, </xsl:if>
                                                    <xsl:value-of select="normalize-space(.)"/>
                                                </xsl:for-each>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        TOPIC CLASSIFICATIONS (Template v1.2, June 2006)
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:subject/ddi:topcClas">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Topics']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:for-each select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:subject/ddi:topcClas">
                                                    <xsl:if test="position()>1">, </xsl:if>
                                                    <xsl:value-of select="normalize-space(.)"/>
                                                </xsl:for-each>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>


                                <!-- SEPARATOR -->
                                <fo:table-row height="0.2in" border-top="{$default-border}" border-bottom="{$default-border}">
                                    <fo:table-cell number-columns-spanned="2">
                                        <fo:block/>
                                    </fo:table-cell>
                                </fo:table-row>


                                <!-- 
                                        *** COVERAGE SECTION (Scope, Coverage) ***
                                -->
                                <xsl:if test="$show-scope-and-coverage = 1">
                                    <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                                        <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block  id="coverage" font-size="12pt" font-weight="normal">
                                                <xsl:value-of select="$msg/*/entry[@key='Coverage']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>


                                <!-- 
                                        UNIVERSE 
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:universe">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Universe']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:universe"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        UNIT OF ANALYSIS 
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:anlyUnit">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Unit_of_Analysis']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:anlyUnit"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>


                                <!-- 
                                        GEO COVERAGE 
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:geogCover">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Geographic_Coverage']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:geogCover"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        GEO UNIT 
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:geogUnit">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Geographic_Unit']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:geogUnit"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- SEPARATOR -->
                                <fo:table-row height="0.2in" border-top="{$default-border}" border-bottom="{$default-border}">
                                    <fo:table-cell number-columns-spanned="2">
                                        <fo:block/>
                                    </fo:table-cell>
                                </fo:table-row>
								
                                <!-- SEPARATOR -->
                                <fo:table-row height="0.2in" border-top="{$default-border}" border-bottom="{$default-border}">
                                    <fo:table-cell number-columns-spanned="2">
                                        <fo:block/>
                                    </fo:table-cell>
                                </fo:table-row>

                                <!-- 
                                        *** SAMPLING SECTION ***
                                -->
                                <xsl:if test="$show-sampling = 1">
                                    <fo:table-row background-color="{$color-gray1}">
                                        <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block id="sampling" font-size="12pt" font-weight="normal">
                                                <xsl:value-of select="$msg/*/entry[@key='Sampling']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        SAMPLING PROCEDURE
                                -->
                                <xsl:choose>
                                    <xsl:when test=" $ddi-flavor='ddp' ">
                                        <!-- DDP: stores the sampling method in <sampProc> and comments in a <notes> element with subject='sampling' -->
                                        <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:sampProc">
                                            <fo:table-row>
                                                <fo:table-cell font-weight="normal" border="{$default-border}" padding="{$cell-padding}">
                                                    <fo:block font-weight="normal">
                                                        <xsl:value-of select="$msg/*/entry[@key='Sampling']"/>
                                                    </fo:block>
                                                </fo:table-cell>
                                                <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                                    <fo:block>
                                                        <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:sampProc"/>
                                                    </fo:block>
                                                </fo:table-cell>
                                            </fo:table-row>
                                        </xsl:if>
                                        <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes[@subject='sampling']">
                                            <fo:table-row>
                                                <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                                                    <fo:block font-weight="bold" text-decoration="none">
                                                        <xsl:value-of select="$msg/*/entry[@key='Sampling_Notes']"/>
                                                    </fo:block>
                                                    <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes[@subject='sampling']"/>
                                                </fo:table-cell>
                                            </fo:table-row>
                                        </xsl:if>
                                    </xsl:when>
                                    <xsl:otherwise>
                                        <!-- Toolkit: the sampling information is free text in a the <sampProc> element-->
                                        <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:sampProc">
                                            <fo:table-row>
                                                <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                                    <fo:block>
                                                        <xsl:value-of select="$msg/*/entry[@key='Sampling_Procedure']"/>
                                                    </fo:block>
                                                </fo:table-cell>
                                                <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                                    <fo:block text-indent="1mm">
                                                        <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:sampProc"/>
                                                    </fo:block>
                                                </fo:table-cell>
                                            </fo:table-row>
                                        </xsl:if>
                                    </xsl:otherwise>
                                </xsl:choose>

                                <!-- 
                                        DEVIATIONS FROM SAMPLE
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:deviat">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Deviations_from_Sample_Design']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:deviat"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        RESPONSE RATE
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:respRate">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Response_Rate']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:respRate"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        WEIGHTING
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:weight">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Weighting']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:weight"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- SEPARATOR -->
                                <fo:table-row height="0.2in" border-top="{$default-border}" border-bottom="{$default-border}">
                                    <fo:table-cell number-columns-spanned="2">
                                        <fo:block/>
                                    </fo:table-cell>
                                </fo:table-row>

                                <!-- 
                                        *** DATA COLLECTION SECTION ***
                                -->
                                <xsl:if test="$show-data-collection = 1">
                                    <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                                        <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block id="data-collection" font-size="12pt" font-weight="normal">
                                                <xsl:value-of select="$msg/*/entry[@key='Data_Collection']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        DATA COLLECTION DATES
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:collDate">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Data_Collection_Dates']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:collDate"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        TIME PERIODS
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:timePrd">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Time_Periods']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:stdyInfo/ddi:sumDscr/ddi:timePrd"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        DATA COLLECTION MODE
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:collMode">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Data_Collection_Mode']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:collMode"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>			

                                <!-- 
                                        DATA COLLECTION FREQUENCY
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:frequenc">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Data_Collection_Frequency']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:frequenc"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>	

                                <!-- 
                                        DATA COLLECTION NOTES 
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:collSitu">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Data_Collection_Notes']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:collSitu"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        QUESTIONNAIRES
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:resInstru">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Questionnaires']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:resInstru"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>		

                                <!-- 
                                        DATA COLLECTORS
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:dataCollector">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Data_Collectors']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:dataCollector"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        SUPERVISION
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:actMin">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Supervision']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:actMin"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>		


                                <!--
                                        *** DATA PROCESSING AND APPRAISAL SECTION *** 
                                -->
                                <xsl:if test="$show-data-processing-and-appraisal = 1">
                                    <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                                        <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block id="data-processing-and-appraisal" font-size="12pt" font-weight="normal">
                                                <xsl:value-of select="$msg/*/entry[@key='Data_Processing_and_Appraisal']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!--
                                        DATA EDITING
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:cleanOps">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Data_Editing']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:dataColl/ddi:cleanOps"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>		

                                <!--
                                        OTHE PROCESSING (IHSN Template v1.2, June 2006) 
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Other_Processing']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:notes"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!--
                                        ESTIMATES OF SAMPLING ERROR
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:EstSmpErr">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Estimates_of_Sampling_Error']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:EstSmpErr"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!--
                                        OTHER DATA APPRAISAL
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:dataAppr">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Other_Forms_of_Data_Appraisal']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:method/ddi:anlyInfo/ddi:dataAppr"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- SEPARATOR -->
                                <fo:table-row height="0.2in" border-top="{$default-border}" border-bottom="{$default-border}">
                                    <fo:table-cell number-columns-spanned="2">
                                        <fo:block/>
                                    </fo:table-cell>
                                </fo:table-row>

                                <!-- 
                                        *** ACCESSIBILITY SECTION ***
                                -->
                                <xsl:if test="$show-accessibility = 1">
                                    <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                                        <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block id="accessibility" font-size="12pt" font-weight="normal">
                                                <xsl:value-of select="$msg/*/entry[@key='Accessibility']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        ACCESS AUTHORITY
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:contact">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Access_Authority']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:contact"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        CONTACTS
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:contact">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Contacts']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:contact"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        DISTRIBUTOR
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:distrbtr">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Distributors']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:distrbtr"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        DEPOSITOR (DDP)
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:depositr">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Depositors']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:distStmt/ddi:depositr"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>	

                                <!-- 
                                        CONFIDENTIALITY
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:confDec">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Confidentiality']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:confDec"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        ACCESS CONDITIONS
                                -->								
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:conditions">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Access_Conditions']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:conditions"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!-- 
                                        CITATION REQUIREMENTS
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:citReq">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Citation_Requirements']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:citReq"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>	

                                <!-- SEPARATOR -->
                                <fo:table-row height="0.2in" border-top="{$default-border}" border-bottom="{$default-border}">
                                    <fo:table-cell number-columns-spanned="2">
                                        <fo:block/>
                                    </fo:table-cell>
                                </fo:table-row>

                                <!-- 
                                       *** RIGHTS AND DISCLAIMER SECTION ***
                                -->
                                <xsl:if test="$show-rights-and-disclaimer = 1">
                                    <fo:table-row background-color="{$color-gray1}" keep-with-next="always">
                                        <fo:table-cell number-columns-spanned="2" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block id="rights-and-disclaimer" font-size="12pt" font-weight="normal">
                                                <xsl:value-of select="$msg/*/entry[@key='Rights_and_Disclaimer']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>

                                <!--
                                       DISCLAIMER
                                -->
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:disclaimer">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Disclaimer']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:dataAccs/ddi:useStmt/ddi:disclaimer"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>	


                                COPYRIGHT
								
                                <xsl:if test="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:prodStmt/ddi:copyright">
                                    <fo:table-row>
                                        <fo:table-cell font-weight="bold" border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block>
                                                <xsl:value-of select="$msg/*/entry[@key='Copyright']"/>
                                            </fo:block>
                                        </fo:table-cell>
                                        <fo:table-cell border="{$default-border}" padding="{$cell-padding}">
                                            <fo:block text-indent="1mm">
                                                <xsl:apply-templates select="/ddi:codeBook/ddi:stdyDscr/ddi:citation/ddi:prodStmt/ddi:copyright"/>
                                            </fo:block>
                                        </fo:table-cell>
                                    </fo:table-row>
                                </xsl:if>	
                                -->
                            </fo:table-body>
                        </fo:table>
                    </fo:flow>
                </fo:page-sequence>
            </xsl:if>
            <!-- 
                    PAGE SEQUENCE: FILES DESCRIPTION
            -->
            <xsl:if test="$show-files-description = 1">
                <fo:page-sequence master-reference="default-page" font-family="{$font-family}" font-size="10pt">
                    <!-- Page Header -->
                    <xsl:call-template name="header">
                        <xsl:with-param name="section">
                            <xsl:value-of select="$msg/*/entry[@key='Files_Description']"/>
                        </xsl:with-param>
                    </xsl:call-template>
                    <!-- Page Footer-->
                    <xsl:call-template name="footer"/>
                    <!-- Page Flow -->
                    <fo:flow flow-name="xsl-region-body">
                        <fo:block id="files-description" font-size="18pt" font-weight="normal" space-after="0.1in">
                            <xsl:value-of select="$msg/*/entry[@key='Files_Description']"/>
                        </fo:block>
                        <!-- count -->
                        <fo:block font-weight="normal">
                            <xsl:value-of select="$msg/*/entry[@key='Dataset_contains']"/>
                            <xsl:text> </xsl:text>
                            <xsl:value-of select="count(/ddi:codeBook/ddi:fileDscr)"/>
                            <xsl:text> </xsl:text>
                            <xsl:value-of select="$msg/*/entry[@key='files']"/>
                        </fo:block>
                        <!-- FILES -->
                        <xsl:apply-templates select="/ddi:codeBook/ddi:fileDscr"/>
                    </fo:flow>
                </fo:page-sequence>
            </xsl:if>		
            <!-- 
                    PAGE SEQUENCE: VARIABLES GROUPS
            -->
            <!-- <xsl:if test="$show-variables-groups = 0">-->
            <fo:page-sequence master-reference="default-page" font-family="{$font-family}" font-size="10pt">
                <!-- Page Header -->
                <xsl:call-template name="header">
                    <xsl:with-param name="section">
                        <xsl:value-of select="$msg/*/entry[@key='Variables_Groups']"/>
                    </xsl:with-param>
                </xsl:call-template>
                <!-- Page Footer-->
                <xsl:call-template name="footer"/>
                <!-- Page Flow -->
                <fo:flow flow-name="xsl-region-body">
                    <fo:block id="variables-groups" font-size="18pt" font-weight="normal" space-after="0.1in">
                        <xsl:value-of select="$msg/*/entry[@key='Variables_Groups']"/>
                    </fo:block>
                    <!-- count -->
                    <fo:block font-weight="normal">
                        <xsl:value-of select="$msg/*/entry[@key='Dataset_contains']"/>
                        <xsl:text> </xsl:text>
                        <xsl:value-of select="count(/ddi:codeBook/ddi:dataDscr/ddi:varGrp)"/>
                        <xsl:text> </xsl:text>
                        <xsl:value-of select="$msg/*/entry[@key='groups']"/>
                    </fo:block>
                    <!-- GROUPS -->
                    <xsl:apply-templates select="/ddi:codeBook/ddi:dataDscr/ddi:varGrp"/>
                </fo:flow>
            </fo:page-sequence>
            <!-- </xsl:if>-->
			
            <!-- 
                    PAGE SEQUENCE: VARIABLES LIST
            -->
            <xsl:if test="$show-variables-list = 1">
                <fo:page-sequence master-reference="{$show-variables-list-layout}" font-family="{$font-family}" font-size="10pt">
                    <!-- Page Header -->
                    <xsl:call-template name="header">
                        <xsl:with-param name="section">
                            <xsl:value-of select="$msg/*/entry[@key='Variables_List']"/>
                        </xsl:with-param>
                    </xsl:call-template>
                    <!-- Page Footer-->
                    <xsl:call-template name="footer"/>
                    <!-- Page Flow -->
                    <fo:flow flow-name="xsl-region-body">
                        <fo:block id="variables-list" font-size="18pt" font-weight="normal" space-after="0.1in">
                            <xsl:value-of select="$msg/*/entry[@key='Variables_List']"/>
                        </fo:block>
                        <!--  count -->
                        <fo:block font-weight="normal">
                            <xsl:value-of select="$msg/*/entry[@key='Dataset_contains']"/>
                            <xsl:text> </xsl:text>
                            <xsl:value-of select="count(/ddi:codeBook/ddi:dataDscr/ddi:var)"/>
                            <xsl:text> </xsl:text>
                            <xsl:value-of select="$msg/*/entry[@key='variables']"/>
                        </fo:block>
                        <!-- VARIABLES -->
                        <xsl:apply-templates select="/ddi:codeBook/ddi:fileDscr" mode="variables-list"/>
                    </fo:flow>
                </fo:page-sequence>
            </xsl:if>
	
            <!-- 
                    PAGE SEQUENCE: ALPHABETICAL VARIABLES LIST
            -->
            <xsl:if test="$show-variables-list = 1">
                <fo:page-sequence master-reference="{$show-variables-list-layout}" font-family="{$font-family}" font-size="10pt">
                    <!-- Page Header -->
                    <xsl:call-template name="header">
                        <xsl:with-param name="section">
                            <xsl:value-of select="$msg/*/entry[@key='Variables_List']"/>
                        </xsl:with-param>
                    </xsl:call-template>
                    <!-- Page Footer-->
                    <xsl:call-template name="footer"/>
                    <!-- Page Flow -->
                    <fo:flow flow-name="xsl-region-body">
                        <fo:block id="variables-list_alpha" font-size="18pt" font-weight="normal" space-after="0.1in">
                            <xsl:value-of select="$msg/*/entry[@key='Alpha_Varlist']"/>
                        </fo:block>
                        <!--  count -->
                        <fo:block font-weight="normal">
                            <xsl:value-of select="$msg/*/entry[@key='Dataset_contains']"/>
                            <xsl:text> </xsl:text>
                            <xsl:value-of select="count(/ddi:codeBook/ddi:dataDscr/ddi:var)"/>
                            <xsl:text> </xsl:text>
                            <xsl:value-of select="$msg/*/entry[@key='variables']"/>
                        </fo:block>
                        <!-- VARIABLES-->
                        <xsl:apply-templates select="/ddi:codeBook/ddi:dataDscr" mode="variables-list_alpha"/>
                    </fo:flow>
                </fo:page-sequence>
            </xsl:if>	
	
            <!-- 
                    PAGE SEQUENCE: VARIABLES DESCRIPTION
            -->
            <xsl:if test="$show-variables-description = 1">
                <fo:page-sequence master-reference="default-page" font-family="{$font-family}" font-size="10pt">
                    <!-- Page Header -->
                    <xsl:call-template name="header">
                        <xsl:with-param name="section">
                            <xsl:value-of select="$msg/*/entry[@key='Variables_Description']"/>
                        </xsl:with-param>
                    </xsl:call-template>
                    <!-- Page Footer-->
                    <xsl:call-template name="footer"/>
                    <!-- Page Flow -->
                    <fo:flow flow-name="xsl-region-body">
                        <fo:block id="variables-description" font-size="18pt" font-weight="normal" space-after="0.1in">
                            <xsl:value-of select="$msg/*/entry[@key='Variables_Description']"/>
                        </fo:block>
                        <!--  count -->
                        <fo:block font-weight="normal">
                            <xsl:value-of select="$msg/*/entry[@key='Dataset_contains']"/>
                            <xsl:value-of select="count(/ddi:codeBook/ddi:dataDscr/ddi:var)"/>
                            <xsl:text> </xsl:text>
                            <xsl:value-of select="$msg/*/entry[@key='variables']"/>
                        </fo:block>
                        <fo:block font-weight="normal" color="{$forsblue}" font-size="10pt" space-before ="1mm">
                            <xsl:value-of select="$msg/*/entry[@key='SumStat_Warning']"/>
                        </fo:block>
						
                        <!-- VARIABLES -->
                        <xsl:apply-templates select="/ddi:codeBook/ddi:fileDscr" mode="variables-description"/>
                    </fo:flow>
                </fo:page-sequence>
            </xsl:if>
            <!-- 
                    PAGE SEQUENCE: DOCUMENTATION
            -->
            <xsl:if test="$show-documentation = 1 and /ddi:codeBook/ddi:otherMat">
                <fo:page-sequence master-reference="default-page" font-family="{$font-family}" font-size="10pt">
                    <!-- Page Header -->
                    <xsl:call-template name="header">
                        <xsl:with-param name="section">
                            <xsl:value-of select="$msg/*/entry[@key='Documentation']"/>
                        </xsl:with-param>
                    </xsl:call-template>
                    <!-- Page Footer-->
                    <xsl:call-template name="footer"/>
                    <!-- Page Flow -->
                    <fo:flow flow-name="xsl-region-body">
                        <fo:block id="documentation" font-size="18pt" font-weight="normal" space-after="0.1in">
                            <xsl:value-of select="$msg/*/entry[@key='Documentation']"/>
                        </fo:block>
						
                        <fo:block id="documentation_hint" font-size="12pt" font-weight="normal" space-after="0.1in">
                            <xsl:value-of select="$msg/*/entry[@key='Documentation_hint']"/>
                        </fo:block>
						
                        <!-- count documents by category -->
                        <xsl:variable name="adm-count" select="count(/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/adm]') ]) "/>
                        <xsl:variable name="anl-count" select="count(/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/anl]') ]) "/>
                        <xsl:variable name="qst-count" select="count(/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/qst]') ]) "/>
                        <xsl:variable name="oth-count" select="count(/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/oth]') ]) "/>
                        <xsl:variable name="ref-count" select="count(/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/ref]') ]) "/>
                        <xsl:variable name="rep-count" select="count(/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/rep]') ]) "/>
                        <xsl:variable name="tec-count" select="count(/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/tec]') ]) "/>
                        <xsl:variable name="tbl-count" select="count(/ddi:codeBook/ddi:otherMat[ contains(@type,'[tbl') ]) "/>
                        <xsl:variable name="prg-count" select="count(/ddi:codeBook/ddi:otherMat[ contains(@type,'[prg') ]) "/>
                        <xsl:variable name="unc-count" select="count(/ddi:codeBook/ddi:otherMat[ not( contains(@type,'[doc') or contains(@type,'[tbl') or contains(@type,'[prg') ) ] )"/>
						
                        <!-- 
                                TOC 
                        -->

                        <fo:block margin-left="0cm" margin-right="0cm" text-decoration="none" space-after="1cm"> 
                            <!-- report/analytrical -->
                            <xsl:if test="$rep-count >0 or $anl-count > 0">
                                <fo:block font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="documentation-anl" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Reports_and_analytical_documents']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="documentation-anl"/>
                                    </fo:basic-link>
                                </fo:block>
                                <xsl:call-template name="documentation-toc-section">
                                    <xsl:with-param name="nodes" select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/rep]')  or contains(@type,'[doc/anl]') ]"/>
                                </xsl:call-template>
                            </xsl:if>
                            <!-- questionnaires -->
                            <xsl:if test="$qst-count >0">
                                <fo:block font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="documentation-qst" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Questionnaires']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="documentation-qst"/>
                                    </fo:basic-link>
                                </fo:block>
                                <xsl:call-template name="documentation-toc-section">
                                    <xsl:with-param name="nodes" select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[prg')]"/>
                                </xsl:call-template>
                                -->
                            </xsl:if>
                            <!-- technical -->
                            <xsl:if test="$tec-count >0">
                                <fo:block font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="documentation-tec" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Technical_documents']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="documentation-tec"/>
                                    </fo:basic-link>
                                </fo:block>
                                <xsl:call-template name="documentation-toc-section">
                                    <xsl:with-param name="nodes" select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[prg')]"/>
                                </xsl:call-template>
                            </xsl:if>
                            <!-- administrative -->
                            <xsl:if test="$adm-count >0">
                                <fo:block font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="documentation-adm" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Administrative_documents']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="documentation-adm"/>
                                    </fo:basic-link>
                                </fo:block>
                                <xsl:call-template name="documentation-toc-section">
                                    <xsl:with-param name="nodes" select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[prg')]"/>
                                </xsl:call-template>
                            </xsl:if>
                            <!-- references -->
                            <xsl:if test="$ref-count >0">
                                <fo:block font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="documentation-ref" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='References']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="documentation-ref"/>
                                    </fo:basic-link>
                                </fo:block>
                                <xsl:call-template name="documentation-toc-section">
                                    <xsl:with-param name="nodes" select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[prg')]"/>
                                </xsl:call-template>
                            </xsl:if>
                            <!-- other -->
                            <xsl:if test="$oth-count >0">
                                <fo:block font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="documentation-oth" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Other_documents']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="documentation-oth"/>
                                    </fo:basic-link>
                                </fo:block>
                                <xsl:call-template name="documentation-toc-section">
                                    <xsl:with-param name="nodes" select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[prg')]"/>
                                </xsl:call-template>
                            </xsl:if>
                            <!-- statistical tables -->
                            <xsl:if test="$tbl-count >0">
                                <fo:block font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="documentation-tbl" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Statistical_tables']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="documentation-tbl"/>
                                    </fo:basic-link>
                                </fo:block>
                                <xsl:call-template name="documentation-toc-section">
                                    <xsl:with-param name="nodes" select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[tbl')]"/>
                                </xsl:call-template>
                            </xsl:if>
                            <!-- scripts and programs -->
                            <xsl:if test="$prg-count >0">
                                <fo:block font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="documentation-prg" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Scripts_and_programs']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <fo:page-number-citation ref-id="documentation-prg"/>
                                    </fo:basic-link>
                                </fo:block>
                                <xsl:call-template name="documentation-toc-section">
                                    <xsl:with-param name="nodes" select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[prg')]"/>
                                </xsl:call-template>
                            </xsl:if>
                            <!-- other resources -->
                            <xsl:if test="$unc-count >0">
                                <fo:block font-size="12pt" text-align-last="justify">
                                    <fo:basic-link internal-destination="documentation-unc" color="{$forsblue}">
                                        <xsl:value-of select="$msg/*/entry[@key='Other_resources']"/>
                                        <fo:leader leader-pattern="dots"/>
                                        <!--										<fo:page-number-citation ref-id="documentation-unc"/>
                                        -->									
                                    </fo:basic-link>
                                </fo:block>
                                <xsl:call-template name="documentation-toc-section">
                                    <xsl:with-param name="nodes" select="/ddi:codeBook/ddi:otherMat[ not( contains(@type,'[doc') or contains(@type,'[tbl') or contains(@type,'[prg') )  ] "/>
                                </xsl:call-template>
                            </xsl:if>
                        </fo:block>
                        -->

                        <!-- 
                                DOCUMENTS 
                        -->
                        <!-- report/analytrical -->
                        <xsl:if test="$rep-count >0 or $anl-count > 0">
                            <fo:block id="documentation-anl" font-size="14pt" font-weight="normal" space-before="1cm" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='Reports_and_analytical_documents']"/>
                            </fo:block>
                            <xsl:apply-templates select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/rep]')  or contains(@type,'[doc/anl]') ]"/>
                        </xsl:if>
                        <!-- questionnaires -->
                        <xsl:if test="$qst-count > 0">
                            <fo:block id="documentation-qst" font-size="14pt" font-weight="normal" space-before="1cm" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='Questionnaires']"/>
                            </fo:block>
                            <xsl:apply-templates select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/qst]') ]"/>
                        </xsl:if>
                        <!-- technical -->
                        <xsl:if test="$tec-count > 0">
                            <fo:block id="documentation-tec" font-size="14pt" font-weight="normal" space-before="1cm" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='Technical_documents']"/>
                            </fo:block>
                            <xsl:apply-templates select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/tec]') ]"/>
                        </xsl:if>
                        <!-- administrative -->
                        <xsl:if test="$adm-count > 0">
                            <fo:block id="documentation-adm" font-size="14pt" font-weight="normal" space-before="1cm" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='Administrative_documents']"/>
                            </fo:block>
                            <xsl:apply-templates select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/adm]') ]"/>
                        </xsl:if>
                        <!-- references -->
                        <xsl:if test="$ref-count > 0">
                            <fo:block id="documentation-ref" font-size="14pt" font-weight="normal" space-before="1cm" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='References']"/>
                            </fo:block>
                            <xsl:apply-templates select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/ref]') ]"/>
                        </xsl:if>
                        <!-- other  -->
                        <xsl:if test="$oth-count > 0">
                            <fo:block id="documentation-oth" font-size="14pt" font-weight="normal" space-before="1cm" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='Other_documents']"/>
                            </fo:block>
                            <xsl:apply-templates select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[doc/oth]') ]"/>
                        </xsl:if>
                        <!-- tables -->
                        <xsl:if test="$tbl-count > 0">
                            <fo:block id="documentation-tbl" font-size="14pt" font-weight="normal" space-before="1cm" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='Statistical_Tables']"/>
                            </fo:block>
                            <xsl:apply-templates select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[tbl') ]"/>
                        </xsl:if>
                        <!-- scripts/programs -->
                        <xsl:if test="$prg-count > 0">
                            <fo:block id="documentation-prg" font-size="14pt" font-weight="normal" space-before="1cm" space-after="0.1in">
                                <xsl:value-of select="$msg/*/entry[@key='Scripts_and_programs']"/>
                            </fo:block>
                            <xsl:apply-templates select="/ddi:codeBook/ddi:otherMat[ contains(@type,'[prg') ]"/>
                        </xsl:if>
                        <!-- other resources -->
                        <xsl:if test="$unc-count > 0">
                        </xsl:if>
                    </fo:flow>
                </fo:page-sequence>
            </xsl:if>
        </fo:root>
</xsl:template>